<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">







<meta name="description" content="DotNet Security Cheat Sheet on the main website for The OWASP Foundation. OWASP is a nonprofit foundation that works to improve the security of software.">
<meta property="og:description" content="DotNet Security Cheat Sheet on the main website for The OWASP Foundation. OWASP is a nonprofit foundation that works to improve the security of software.">
<meta propery="og:title" content="cheat sheets | DotNet Security Cheat Sheet | OWASP Foundation">
<meta property="og:url" content="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/DotNet_Security_Cheat_Sheet.html">
<meta property="og:locale" content="en_US">

<!-- should probably look at using article at some point for www-community at least -->
<meta property="og:type" content="website" />
<meta property="og:image" content="https://owasp.org/www--site-theme/favicon.ico" />
<meta http-equiv="X-Content-Type-Options" content="nosniff">
<meta http-equiv="X-XSS-Protection" content="1; mode=block">


<link rel="canonical" href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/DotNet_Security_Cheat_Sheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=UA-4531126-1"></script> -->
<!-- <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-4531126-1');
</script> -->
<!-- Google Analytics -->


<script src="https://owasp.org/www--site-theme/assets/js/js.cookie.js"></script>
<script>
  if(Cookies.get('cookies-ok') == 'true' && window.ga === undefined)
  {
    window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
    ga('create', 'UA-4531126-1', 'auto');
    ga('send', 'pageview');
  }
  else if (Cookies.get('cookies-ok') == 'true')
  {
    ga('send', 'pageview');
  }

  function handleOutboundLinkClicks(event) {
    var href = '';
    if(event.target.href == undefined)
      href = event.target.parentElement.href;
    else
      href = event.target.href
  if(Cookies.get('cookies-ok') == 'true'){  
    
    ga('send', 'event', {
      eventCategory: 'Outbound Link',
      eventAction: 'click',
      eventLabel: href,
      transport: 'beacon'
    });
  }
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<!-- End Google Analytics -->
<link rel="stylesheet" href="https://owasp.org/www--site-theme/assets/css/styles.css">
<link rel="shortcut icon" type="images/x-icon" href="https://owasp.org/www--site-theme/favicon.ico">

<script src="https://owasp.org/www--site-theme/assets/js/jquery-3.4.1.min.js"></script>
<script src="https://owasp.org/www--site-theme/assets/js/util.js"></script>
<script src="https://owasp.org/www--site-theme/assets/js/yaml.min.js"></script>
<script src="https://owasp.org/www--site-theme/assets/js/luxon.min.js"></script>
<title>DotNet Security Cheat Sheet | OWASP</title>

    <script type="text/javascript">
      $(function(){
        var baseurl = "https://github.com/owaspankara/www-chapter-ankara/blob/master/";
        var path = "cheatsheets/DotNet_Security_Cheat_Sheet.md";
        $('.repo').html('<a href=' + baseurl + path + '><div class="reset-3c756112--menuItemIcon-206eb252" style="float: left;"><svg preserveAspectRatio="xMidYMid meet" height="1em" width="1em" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 438.549 438.549" stroke="none" class="icon-7f6730be--text-3f89f380"><g><path d="M409.132 114.573c-19.608-33.596-46.205-60.194-79.798-79.8-33.598-19.607-70.277-29.408-110.063-29.408-39.781 0-76.472 9.804-110.063 29.408-33.596 19.605-60.192 46.204-79.8 79.8C9.803 148.168 0 184.854 0 224.63c0 47.78 13.94 90.745 41.827 128.906 27.884 38.164 63.906 64.572 108.063 79.227 5.14.954 8.945.283 11.419-1.996 2.475-2.282 3.711-5.14 3.711-8.562 0-.571-.049-5.708-.144-15.417a2549.81 2549.81 0 0 1-.144-25.406l-6.567 1.136c-4.187.767-9.469 1.092-15.846 1-6.374-.089-12.991-.757-19.842-1.999-6.854-1.231-13.229-4.086-19.13-8.559-5.898-4.473-10.085-10.328-12.56-17.556l-2.855-6.57c-1.903-4.374-4.899-9.233-8.992-14.559-4.093-5.331-8.232-8.945-12.419-10.848l-1.999-1.431c-1.332-.951-2.568-2.098-3.711-3.429-1.142-1.331-1.997-2.663-2.568-3.997-.572-1.335-.098-2.43 1.427-3.289 1.525-.859 4.281-1.276 8.28-1.276l5.708.853c3.807.763 8.516 3.042 14.133 6.851 5.614 3.806 10.229 8.754 13.846 14.842 4.38 7.806 9.657 13.754 15.846 17.847 6.184 4.093 12.419 6.136 18.699 6.136 6.28 0 11.704-.476 16.274-1.423 4.565-.952 8.848-2.383 12.847-4.285 1.713-12.758 6.377-22.559 13.988-29.41-10.848-1.14-20.601-2.857-29.264-5.14-8.658-2.286-17.605-5.996-26.835-11.14-9.235-5.137-16.896-11.516-22.985-19.126-6.09-7.614-11.088-17.61-14.987-29.979-3.901-12.374-5.852-26.648-5.852-42.826 0-23.035 7.52-42.637 22.557-58.817-7.044-17.318-6.379-36.732 1.997-58.24 5.52-1.715 13.706-.428 24.554 3.853 10.85 4.283 18.794 7.952 23.84 10.994 5.046 3.041 9.089 5.618 12.135 7.708 17.705-4.947 35.976-7.421 54.818-7.421s37.117 2.474 54.823 7.421l10.849-6.849c7.419-4.57 16.18-8.758 26.262-12.565 10.088-3.805 17.802-4.853 23.134-3.138 8.562 21.509 9.325 40.922 2.279 58.24 15.036 16.18 22.559 35.787 22.559 58.817 0 16.178-1.958 30.497-5.853 42.966-3.9 12.471-8.941 22.457-15.125 29.979-6.191 7.521-13.901 13.85-23.131 18.986-9.232 5.14-18.182 8.85-26.84 11.136-8.662 2.286-18.415 4.004-29.263 5.146 9.894 8.562 14.842 22.077 14.842 40.539v60.237c0 3.422 1.19 6.279 3.572 8.562 2.379 2.279 6.136 2.95 11.276 1.995 44.163-14.653 80.185-41.062 108.068-79.226 27.88-38.161 41.825-81.126 41.825-128.906-.01-39.771-9.818-76.454-29.414-110.049z"></path></g></svg><span style="padding-left:8px;">Edit on GitHub</span></div></a>');
      });
    </script>
    <script async defer src="https://buttons.github.io/buttons.js"></script>
  </head>
  <body class="base-grid col-sidebar">

    <div id="blocker"></div>

    <noscript>For full functionality of this site it is necessary to enable JavaScript. Here are the <a href="https://www.enable-javascript.com/"> instructions how to enable JavaScript in your web browser</a>.</noscript>
    <header role="banner">
  <div id="banner" class="notice" aria-label="announcement">
  <!--
	<p>Consider <a href="/membership">becoming a Member</a> of the OWASP Foundation. It's affordable and your contributions make a difference.</p>
  -->
 
	<p>Please support the OWASP mission to improve sofware security through open source initiatives and community education. <a href="https://owasp.org/donate/">Donate Now!</a></p>
	
	<a href="#" id="close-banner" aria-label="close announcement">
          <i class="fa fa-times"></i>
       </a>	  
</div>

<style>
  #banner img {
    max-width: 30em;
  }

  @media (max-width: 1131px) {
    #banner img{
      max-width: 30em;
    }
	}

@media (max-width: 800px) {
	#banner img{
      max-width: 20em;
    }
}

@media (max-width: 600px) {
	#banner img{
      max-width: 20em;
    }
}

@media (max-width: 450px) {
	#banner img{
      max-width: 250px;
  }
}
</style>

  <div class="header-wrapper" aria-label="main navigation">
    <nav class="alt-nav">
      <a href="#" class="menu-toggler" aria-hidden="true">
        <i class="fa fa-bars"></i>
      </a>
      <a href="/" class="alt-logo" aria-label="go to homepage">
          <img src="/assets/images/logo.png" alt="OWASP logo">
      </a>
      <div id="overlay" class="remove-el">

      </div>
      <!-- jekyll menu stuff -->
    </nav>
    
    <nav class="top-nav" role="navigation" aria-label="primary navigation">
      <a href="/" class="desktop-logo" aria-label="go to homepage">
        <img src="/assets/images/logo.png" alt="">
      </a>
      <!-- jekyll menu stuff -->
      
      <div class="interactive-wrapper">
        <form role="search" method="get" action="/search">   
          <div class='search-div'>
            <input id="searchString" name="searchString" class="search-bar" type="search" placeholder="Search OWASP.org" required="true">
            <button id="search-button" type="submit" class="fa fa-search">
                <!--<span id="search-icon" tabindex="0"><i class="fa fa-search"></i></span>-->
            </button>
          </div>  
        </form>
        <div class="nav-button" aria-label="donate to or join OWASP">
        
          <a href="/donate?reponame=www-chapter-ankara&title=DotNet+Security+Cheat+Sheet" class="cta-button green">Donate</a>
          <a href="/membership" class="cta-button">Join</a>
        </div>
      </div>
    </nav>
    <div id='disclaimer-container'>
<div id="disclaimer">
    <p>This website uses cookies to analyze our traffic and only share that information with our analytics partners.</p><a class="disclaimerOK">Accept</a>
</div>
<div id="close-disclaimer">x</div>
</div>
  </div>
  



<script type="text/javascript">
  $(function(){
      
      url = $(location).attr('href');
      if(url.includes('www2'))
      {
        url = url.replace(/www2./, '');
        $(location).attr('href',url);
        return;
      }
    // this works to get data from a json file NOT in data
      $.getJSON("https://owasp.org/www--site-theme/assets/sitedata/menus.json", function(data) {
         var listr = "<ul aria-label='header menu'>";
         
         var mlistr = "<ul class='mobile-menu hide-el' role='navigation' aria-label='mobile primary navigation'>";

          mlistr += "<li><a href='#' class='menu-toggler' aria-hidden='true'><i class='fa fa-times'></i></a></li>";
          mlistr += "<li>";
          mlistr += "<form role='search' method='get' action='/search'>";   
          mlistr += "<div class='search-div'>";
          mlistr += "<input id='searchString' aria-label='search input' name='searchString' class='search-bar' type='search' placeholder='Search OWASP.org' required='true'>";
          mlistr += "<button id='search-button' aria-label='search button' type='submit' class='fa fa-search' style='padding-left: 8px;'></button></div></form>";
          mlistr += "</li>";
          $.each(data.menus, function (ndx, menu){
              listr += "<li><a href='" + menu.url + "'>" + menu.title + "</a>";

              if(!menu.items)
              {
                  mlistr += "<li><a href='" + menu.url + "'>" + menu.title + "</a>";
              }
              
              if(menu.items){
                  listr += "<ul class='dropdown-menu'>";
                  mlistr += "<button class='accordion'>" + menu.title + "</button>";
                  mlistr += "<div class='panel'>";
                  mlistr += "<ul>";
                $.each(menu.items, function(ndx, item){
                
                  if(item.separator)
                  {
                      listr += "<li class='separator'>";
                      mlistr += "<li class='separator'>";
                  }
                  else
                  {
                      listr += "<li>";
                      mlistr += "<li>";
                  }
                  listr += "<a href='" + item.url + "'";
                  mlistr += "<a href='" + item.url + "'";
                  if(item.opentab)
                  {
                    listr += " target='_blank' rel='noopener noreferrer'";
                    mlistr += " target='_blank' rel='noopener noreferrer'";
                  }

                  listr += ">" + item.title + "</a></li>";
                  mlistr += ">" + item.title + "</a></li>";
                });
                listr += "</ul>";
                mlistr += "</ul>";
                mlistr += "</div>"
              }
              
              listr += "</li>";
              mlistr += "</li>";
          });
          listr += "</ul>";
          mlistr += "<li><a href='/donate'>MAKE A DONATION</a></li>";
          mlistr += "<li><a href='/membership'>BECOME A MEMBER</a></li>";
          mlistr += "<li><a href='/sitemap'>SITEMAP</a></li>";
          mlistr += "</ul>";
          
          $('.desktop-logo').after(listr);
          $('#overlay').after(mlistr);

          $(".accordion").click(function () {
              $(this).toggleClass("active");
              if($(this).next('.panel').css('display') == 'block'){
                $(this).next('.panel').css('display', 'none');
              }
              else {
                $(this).next('.panel').css('display', 'block');
              }
            });
            $(".menu-toggler").click(function() {
              $(".mobile-menu").toggleClass('hide-el');
            });
      });
    });
  </script>
</header>


    <main role="main">
      <div class="main-wrapper document">
        
  
  
  
  
  
  
  




                




    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
        
        
        <div id="main" class="page-body tab" role="tabpanel" aria-labelledby="main-link" tabindex="0">
          <div class="doc-title">cheat sheets</div>
          <h1 class="page-title">DotNet Security Cheat Sheet</h1>
          
          <nav role="navigation" aria-label="navigate page">
              <ol>
              
                
                <li class='page previous'><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Docker_Security_Cheat_Sheet"><span style="font-size: 3em; color: lightgray; vertical-align:middle;">
                    <i class="fas fa-angle-left"></i>
                  </span>Docker Security Cheat Sheet</a></li>
              
              
                
                <li class='page next'><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Error_Handling_Cheat_Sheet">Error Handling Cheat Sheet<span style="font-size: 3em; color: lightgray; vertical-align:middle;">
                    <i class="fas fa-angle-right"></i>
                  </span></a></li>
              
              </ol>
          </nav>
          
          <section id='div-main' class='page-body tab'>
          <h1 id="introduction">Introduction</h1>

<p>This page intends to provide quick basic .NET security tips for developers.</p>

<h2 id="the-net-framework">The .NET Framework</h2>

<p>The .NET Framework is Microsoft’s principal platform for enterprise development. It is the supporting API for ASP.NET, Windows Desktop applications, Windows Communication Foundation services, SharePoint, Visual Studio Tools for Office and other technologies.</p>

<h2 id="updating-the-framework">Updating the Framework</h2>

<p>The .NET Framework is kept up-to-date by Microsoft with the Windows Update service. Developers do not normally need to run separate updates to the Framework. Windows Update can be accessed at <a href="http://windowsupdate.microsoft.com/">Windows Update</a> or from the Windows Update program on a Windows computer.</p>

<p>Individual frameworks can be kept up to date using <a href="http://nuget.codeplex.com/wikipage?title=Getting%20Started&amp;referringTitle=Home">NuGet</a>. As Visual Studio prompts for updates, build it into your lifecycle.</p>

<p>Remember that third-party libraries have to be updated separately and not all of them use NuGet. ELMAH for instance, requires a separate update effort.</p>

<h2 id="security-announcements">Security Announcements</h2>

<p>Receive security notifications by selecting the “Watch” button at the following repositories:</p>

<ul>
  <li><a href="https://github.com/dotnet/announcements/issues?q=is%3Aopen+is%3Aissue+label%3ASecurity">.NET Core Security Announcements</a></li>
  <li><a href="https://github.com/aspnet/Announcements/issues?q=is%3Aopen+is%3Aissue+label%3ASecurity">ASP.NET Core &amp; Entity Framework Core Security Announcements</a></li>
</ul>

<h1 id="net-framework-guidance">.NET Framework Guidance</h1>

<p>The .NET Framework is the set of APIs that support an advanced type system, data, graphics, network, file handling and most of the rest of what is needed to write enterprise apps in the Microsoft ecosystem. It is a nearly ubiquitous library that is strongly named and versioned at the assembly level.</p>

<h2 id="data-access">Data Access</h2>

<ul>
  <li>Use <a href="https://docs.microsoft.com/en-us/dotnet/api/system.data.sqlclient.sqlcommand.prepare?view=netframework-4.7.2">Parameterized SQL</a> commands for all data access, without exception.</li>
  <li>Do not use <a href="http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.aspx">SqlCommand</a> with a string parameter made up of a <a href="https://docs.microsoft.com/en-gb/visualstudio/code-quality/ca2100-review-sql-queries-for-security-vulnerabilities?view=vs-2017">concatenated SQL String</a>.</li>
  <li>Whitelist allowable values coming from the user. Use enums, <a href="http://msdn.microsoft.com/en-us/library/f02979c7.aspx">TryParse</a> or lookup values to assure that the data coming from the user is as expected.
    <ul>
      <li>Enums are still vulnerable to unexpected values because .NET only validates a successful cast to the underlying data type, integer by default. <a href="https://msdn.microsoft.com/en-us/library/system.enum.isdefined">Enum.IsDefined</a> can validate whether the input value is valid within the list of defined constants.</li>
    </ul>
  </li>
  <li>Apply the principle of least privilege when setting up the Database User in your database of choice. The database user should only be able to access items that make sense for the use case.</li>
  <li>Use of the <a href="http://msdn.microsoft.com/en-us/data/ef.aspx">Entity Framework</a> is a very effective <a href="https://www.owasp.org/index.php/SQL_Injection">SQL injection</a> prevention mechanism. <strong>Remember that building your own ad hoc queries in Entity Framework is just as susceptible to SQLi as a plain SQL query</strong>.</li>
  <li>When using SQL Server, prefer <a href="https://docs.microsoft.com/en-us/sql/connect/odbc/linux-mac/using-integrated-authentication?view=sql-server-2017">integrated authentication</a> over <a href="https://docs.microsoft.com/en-us/sql/relational-databases/security/choose-an-authentication-mode?view=sql-server-2017#connecting-through-sql-server-authentication">SQL authentication</a>.</li>
  <li>Use <a href="https://msdn.microsoft.com/en-us/library/mt163865.aspx">Always Encrypted</a> where possible for sensitive data (SQL Server 2016 and SQL Azure),</li>
</ul>

<h2 id="encryption">Encryption</h2>

<ul>
  <li><strong>Never, ever write your own encryption.</strong></li>
  <li>Use the <a href="http://msdn.microsoft.com/en-us/library/ms995355.aspx">Windows Data Protection API (DPAPI)</a> for secure local storage of sensitive data.</li>
  <li>Use a strong hash algorithm.
    <ul>
      <li>In .NET (both Framework and Core) the strongest hashing algorithm for general hashing requirements is <a href="http://msdn.microsoft.com/en-us/library/system.security.cryptography.sha512.aspx">System.Security.Cryptography.SHA512</a>.</li>
      <li>In the .NET framework the strongest algorithm for password hashing is PBKDF2, implemented as <a href="http://msdn.microsoft.com/en-us/library/system.security.cryptography.rfc2898derivebytes(v=vs.110).aspx">System.Security.Cryptography.Rfc2898DeriveBytes</a>.</li>
      <li>In .NET Core the strongest algorithm for password hashing is PBKDF2, implemented as <a href="https://docs.microsoft.com/en-us/aspnet/core/security/data-protection/consumer-apis/password-hashing">Microsoft.AspNetCore.Cryptography.KeyDerivation.Pbkdf2</a> which has several significant advantages over <code class="language-plaintext highlighter-rouge">Rfc2898DeriveBytes</code>.</li>
      <li>When using a hashing function to hash non-unique inputs such as passwords, use a salt value added to the original value before hashing.</li>
    </ul>
  </li>
  <li>Make sure your application or protocol can easily support a future change of cryptographic algorithms.</li>
  <li>Use <a href="https://docs.microsoft.com/en-us/nuget/">Nuget</a> to keep all of your packages up to date. Watch the updates on your development setup, and plan updates to your applications accordingly.</li>
</ul>

<h2 id="general">General</h2>

<ul>
  <li>Lock down the config file.
    <ul>
      <li>Remove all aspects of configuration that are not in use.</li>
      <li>Encrypt sensitive parts of the <code class="language-plaintext highlighter-rouge">web.config</code> using <code class="language-plaintext highlighter-rouge">aspnet_regiis -pe</code> (<a href="https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-2.0/k6h9cz8h(v=vs.80)">command line help</a>).</li>
    </ul>
  </li>
  <li>For Click Once applications the .Net Framework should be upgraded to use version <code class="language-plaintext highlighter-rouge">4.6.2</code> to ensure <code class="language-plaintext highlighter-rouge">TLS 1.1/1.2</code> support.</li>
</ul>

<h1 id="asp-net-web-forms-guidance">ASP NET Web Forms Guidance</h1>

<p>ASP.NET Web Forms is the original browser-based application development API for the .NET framework, and is still the most common enterprise platform for web application development.</p>

<ul>
  <li>Always use <a href="http://support.microsoft.com/kb/324069">HTTPS</a>.</li>
  <li>Enable <a href="http://msdn.microsoft.com/en-us/library/system.web.configuration.httpcookiessection.requiressl.aspx">requireSSL</a> on cookies and form elements and <a href="http://msdn.microsoft.com/en-us/library/system.web.configuration.httpcookiessection.httponlycookies.aspx">HttpOnly</a> on cookies in the web.config.</li>
  <li>Implement <a href="https://msdn.microsoft.com/en-us/data/h0hfz6fc(v=vs.110)">customErrors</a>.</li>
  <li>Make sure <a href="http://www.iis.net/configreference/system.webserver/tracing">tracing</a> is turned off.</li>
  <li>While viewstate isn’t always appropriate for web development, using it can provide CSRF mitigation. To make the ViewState protect against CSRF attacks you need to set the <a href="http://msdn.microsoft.com/en-us/library/ms972969.aspx#securitybarriers_topic2">ViewStateUserKey</a>:</li>
</ul>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">protected</span><span class="err"> </span><span class="k">override</span><span class="err"> </span><span class="nf">OnInit</span><span class="p">(</span><span class="n">EventArgs</span><span class="err"> </span><span class="n">e</span><span class="p">)</span><span class="err"> </span><span class="p">{</span>
<span class="err">    </span><span class="k">base</span><span class="p">.</span><span class="nf">OnInit</span><span class="p">(</span><span class="n">e</span><span class="p">);</span><span class="err"> </span>
<span class="err">    </span><span class="n">ViewStateUserKey</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="n">Session</span><span class="p">.</span><span class="n">SessionID</span><span class="p">;</span>
<span class="p">}</span><span class="err"> </span>
</code></pre></div></div>

<p>If you don’t use Viewstate, then look to the default master page of the ASP.NET Web Forms default template for a manual anti-CSRF token using a double-submit cookie.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">private</span><span class="err"> </span><span class="k">const</span><span class="err"> </span><span class="kt">string</span><span class="err"> </span><span class="n">AntiXsrfTokenKey</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="s">"__AntiXsrfToken"</span><span class="p">;</span>
<span class="k">private</span><span class="err"> </span><span class="k">const</span><span class="err"> </span><span class="kt">string</span><span class="err"> </span><span class="n">AntiXsrfUserNameKey</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="s">"__AntiXsrfUserName"</span><span class="p">;</span>
<span class="k">private</span><span class="err"> </span><span class="kt">string</span><span class="err"> </span><span class="n">_antiXsrfTokenValue</span><span class="p">;</span>
<span class="k">protected</span><span class="err"> </span><span class="k">void</span><span class="err"> </span><span class="nf">Page_Init</span><span class="p">(</span><span class="kt">object</span><span class="err"> </span><span class="n">sender</span><span class="p">,</span><span class="err"> </span><span class="n">EventArgs</span><span class="err"> </span><span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
<span class="err">    </span><span class="c1">// The code below helps to protect against XSRF attacks</span>
<span class="err">    </span><span class="kt">var</span><span class="err"> </span><span class="n">requestCookie</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="n">Request</span><span class="p">.</span><span class="n">Cookies</span><span class="p">[</span><span class="n">AntiXsrfTokenKey</span><span class="p">];</span>
<span class="err">    </span><span class="n">Guid</span><span class="err"> </span><span class="n">requestCookieGuidValue</span><span class="p">;</span>
<span class="err">    </span><span class="k">if</span><span class="err"> </span><span class="p">(</span><span class="n">requestCookie</span><span class="err"> </span><span class="p">!=</span><span class="err"> </span><span class="k">null</span><span class="err"> </span><span class="p">&amp;&amp;</span><span class="err"> </span><span class="n">Guid</span><span class="p">.</span><span class="nf">TryParse</span><span class="p">(</span><span class="n">requestCookie</span><span class="p">.</span><span class="n">Value</span><span class="p">,</span><span class="err"> </span><span class="k">out</span><span class="err"> </span><span class="n">requestCookieGuidValue</span><span class="p">))</span>
<span class="err">    </span><span class="p">{</span>
<span class="err">       </span><span class="c1">// Use the Anti-XSRF token from the cookie</span>
<span class="err">       </span><span class="n">_antiXsrfTokenValue</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="n">requestCookie</span><span class="p">.</span><span class="n">Value</span><span class="p">;</span>
<span class="err">       </span><span class="n">Page</span><span class="p">.</span><span class="n">ViewStateUserKey</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="n">_antiXsrfTokenValue</span><span class="p">;</span>
<span class="err">    </span><span class="p">}</span>
<span class="err">    </span><span class="k">else</span>
<span class="err">    </span><span class="p">{</span>
<span class="err">       </span><span class="c1">// Generate a new Anti-XSRF token and save to the cookie</span>
<span class="err">       </span><span class="n">_antiXsrfTokenValue</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="n">Guid</span><span class="p">.</span><span class="nf">NewGuid</span><span class="p">().</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"N"</span><span class="p">);</span>
<span class="err">       </span><span class="n">Page</span><span class="p">.</span><span class="n">ViewStateUserKey</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="n">_antiXsrfTokenValue</span><span class="p">;</span>
<span class="err">       </span><span class="kt">var</span><span class="err"> </span><span class="n">responseCookie</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="k">new</span><span class="err"> </span><span class="nf">HttpCookie</span><span class="p">(</span><span class="n">AntiXsrfTokenKey</span><span class="p">)</span>
<span class="err">       </span><span class="p">{</span>
<span class="err">          </span><span class="n">HttpOnly</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="k">true</span><span class="p">,</span>
<span class="err">          </span><span class="n">Value</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="n">_antiXsrfTokenValue</span>
<span class="err">       </span><span class="p">};</span>
<span class="err">       </span><span class="k">if</span><span class="err"> </span><span class="p">(</span><span class="n">FormsAuthentication</span><span class="p">.</span><span class="n">RequireSSL</span><span class="err"> </span><span class="p">&amp;&amp;</span><span class="err"> </span><span class="n">Request</span><span class="p">.</span><span class="n">IsSecureConnection</span><span class="p">)</span>
<span class="err">       </span><span class="p">{</span>
<span class="err">          </span><span class="n">responseCookie</span><span class="p">.</span><span class="n">Secure</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="k">true</span><span class="p">;</span>
<span class="err">       </span><span class="p">}</span>
<span class="err">       </span><span class="n">Response</span><span class="p">.</span><span class="n">Cookies</span><span class="p">.</span><span class="nf">Set</span><span class="p">(</span><span class="n">responseCookie</span><span class="p">);</span>
<span class="err">    </span><span class="p">}</span>
<span class="err">    </span><span class="n">Page</span><span class="p">.</span><span class="n">PreLoad</span><span class="err"> </span><span class="p">+=</span><span class="err"> </span><span class="n">master_Page_PreLoad</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">protected</span><span class="err"> </span><span class="k">void</span><span class="err"> </span><span class="nf">master_Page_PreLoad</span><span class="p">(</span><span class="kt">object</span><span class="err"> </span><span class="n">sender</span><span class="p">,</span><span class="err"> </span><span class="n">EventArgs</span><span class="err"> </span><span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
<span class="err">    </span><span class="k">if</span><span class="err"> </span><span class="p">(!</span><span class="n">IsPostBack</span><span class="p">)</span>
<span class="err">    </span><span class="p">{</span>
<span class="err">       </span><span class="c1">// Set Anti-XSRF token</span>
<span class="err">       </span><span class="n">ViewState</span><span class="p">[</span><span class="n">AntiXsrfTokenKey</span><span class="p">]</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="n">Page</span><span class="p">.</span><span class="n">ViewStateUserKey</span><span class="p">;</span>
<span class="err">       </span><span class="n">ViewState</span><span class="p">[</span><span class="n">AntiXsrfUserNameKey</span><span class="p">]</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="n">Context</span><span class="p">.</span><span class="n">User</span><span class="p">.</span><span class="n">Identity</span><span class="p">.</span><span class="n">Name</span><span class="err"> </span><span class="p">??</span><span class="err"> </span><span class="n">String</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
<span class="err">    </span><span class="p">}</span>
<span class="err">    </span><span class="k">else</span>
<span class="err">    </span><span class="p">{</span>
<span class="err">       </span><span class="c1">// Validate the Anti-XSRF token</span>

<span class="k">if</span> <span class="p">((</span><span class="kt">string</span><span class="p">)</span><span class="n">ViewState</span><span class="p">[</span><span class="n">AntiXsrfTokenKey</span><span class="p">]</span> <span class="p">!=</span> <span class="n">_antiXsrfTokenValue</span> <span class="p">||</span>
<span class="err">          </span><span class="p">(</span><span class="kt">string</span><span class="p">)</span><span class="n">ViewState</span><span class="p">[</span><span class="n">AntiXsrfUserNameKey</span><span class="p">]</span><span class="err"> </span><span class="p">!=</span><span class="err"> </span><span class="p">(</span><span class="n">Context</span><span class="p">.</span><span class="n">User</span><span class="p">.</span><span class="n">Identity</span><span class="p">.</span><span class="n">Name</span><span class="err"> </span><span class="p">??</span><span class="err"> </span><span class="n">String</span><span class="p">.</span><span class="n">Empty</span><span class="p">))</span>
<span class="err">       </span><span class="p">{</span>
<span class="err">          </span><span class="k">throw</span><span class="err"> </span><span class="k">new</span><span class="err"> </span><span class="nf">InvalidOperationException</span><span class="p">(</span><span class="s">"Validation of Anti-XSRF token failed."</span><span class="p">);</span>
<span class="err">       </span><span class="p">}</span>
<span class="err">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<ul>
  <li>Consider <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security">HSTS</a> in IIS. See <a href="https://support.microsoft.com/en-us/help/954002/how-to-add-a-custom-http-response-header-to-a-web-site-that-is-hosted">here</a> for the procedure.</li>
  <li>This is a recommended <code class="language-plaintext highlighter-rouge">web.config</code> setup that handles HSTS among other things.</li>
</ul>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
 <span class="nt">&lt;configuration&gt;</span>
   <span class="nt">&lt;system.web&gt;</span>
     <span class="nt">&lt;httpRuntime</span> <span class="na">enableVersionHeader=</span><span class="s">"false"</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;/system.web&gt;</span>
   <span class="nt">&lt;system.webServer&gt;</span>
     <span class="nt">&lt;security&gt;</span>
       <span class="nt">&lt;requestFiltering</span> <span class="na">removeServerHeader=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
     <span class="nt">&lt;/security&gt;</span>
     <span class="nt">&lt;staticContent&gt;</span>
       <span class="nt">&lt;clientCache</span> <span class="na">cacheControlCustom=</span><span class="s">"public"</span> 
            <span class="na">cacheControlMode=</span><span class="s">"UseMaxAge"</span>    
            <span class="na">cacheControlMaxAge=</span><span class="s">"1.00:00:00"</span> 
            <span class="na">setEtag=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
     <span class="nt">&lt;/staticContent&gt;</span>
     <span class="nt">&lt;httpProtocol&gt;</span>
       <span class="nt">&lt;customHeaders&gt;</span>
         <span class="nt">&lt;add</span> <span class="na">name=</span><span class="s">"Content-Security-Policy"</span> 
            <span class="na">value=</span><span class="s">"default-src 'none'; style-src 'self'; img-src 'self'; font-src 'self'"</span> <span class="nt">/&gt;</span>
         <span class="nt">&lt;add</span> <span class="na">name=</span><span class="s">"X-Content-Type-Options"</span> <span class="na">value=</span><span class="s">"NOSNIFF"</span> <span class="nt">/&gt;</span>
         <span class="nt">&lt;add</span> <span class="na">name=</span><span class="s">"X-Frame-Options"</span> <span class="na">value=</span><span class="s">"DENY"</span> <span class="nt">/&gt;</span>
         <span class="nt">&lt;add</span> <span class="na">name=</span><span class="s">"X-Permitted-Cross-Domain-Policies"</span> <span class="na">value=</span><span class="s">"master-only"</span><span class="nt">/&gt;</span>
         <span class="nt">&lt;add</span> <span class="na">name=</span><span class="s">"X-XSS-Protection"</span> <span class="na">value=</span><span class="s">"1; mode=block"</span><span class="nt">/&gt;</span>
         <span class="nt">&lt;remove</span> <span class="na">name=</span><span class="s">"X-Powered-By"</span><span class="nt">/&gt;</span>
       <span class="nt">&lt;/customHeaders&gt;</span>
     <span class="nt">&lt;/httpProtocol&gt;</span>
     <span class="nt">&lt;rewrite&gt;</span>
       <span class="nt">&lt;rules&gt;</span>
         <span class="nt">&lt;rule</span> <span class="na">name=</span><span class="s">"Redirect to https"</span><span class="nt">&gt;</span>
           <span class="nt">&lt;match</span> <span class="na">url=</span><span class="s">"(.*)"</span><span class="nt">/&gt;</span>
           <span class="nt">&lt;conditions&gt;</span>
             <span class="nt">&lt;add</span> <span class="na">input=</span><span class="s">"{HTTPS}"</span> <span class="na">pattern=</span><span class="s">"Off"</span><span class="nt">/&gt;</span>
             <span class="nt">&lt;add</span> <span class="na">input=</span><span class="s">"{REQUEST_METHOD}"</span> <span class="na">pattern=</span><span class="s">"^get$|^head$"</span> <span class="nt">/&gt;</span>
           <span class="nt">&lt;/conditions&gt;</span>
           <span class="nt">&lt;action</span> <span class="na">type=</span><span class="s">"Redirect"</span> <span class="na">url=</span><span class="s">"https://{HTTP_HOST}/{R:1}"</span> <span class="na">redirectType=</span><span class="s">"Permanent"</span><span class="nt">/&gt;</span>
         <span class="nt">&lt;/rule&gt;</span>
       <span class="nt">&lt;/rules&gt;</span>
       <span class="nt">&lt;outboundRules&gt;</span>
         <span class="nt">&lt;rule</span> <span class="na">name=</span><span class="s">"Add HSTS Header"</span> <span class="na">enabled=</span><span class="s">"true"</span><span class="nt">&gt;</span>
           <span class="nt">&lt;match</span> <span class="na">serverVariable=</span><span class="s">"RESPONSE_Strict_Transport_Security"</span> <span class="na">pattern=</span><span class="s">".*"</span> <span class="nt">/&gt;</span>
           <span class="nt">&lt;conditions&gt;</span>
             <span class="nt">&lt;add</span> <span class="na">input=</span><span class="s">"{HTTPS}"</span> <span class="na">pattern=</span><span class="s">"on"</span> <span class="na">ignoreCase=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
           <span class="nt">&lt;/conditions&gt;</span>
           <span class="nt">&lt;action</span> <span class="na">type=</span><span class="s">"Rewrite"</span> <span class="na">value=</span><span class="s">"max-age=15768000"</span> <span class="nt">/&gt;</span>
         <span class="nt">&lt;/rule&gt;</span>
       <span class="nt">&lt;/outboundRules&gt;</span>
     <span class="nt">&lt;/rewrite&gt;</span>
   <span class="nt">&lt;/system.webServer&gt;</span>
 <span class="nt">&lt;/configuration&gt;</span>
</code></pre></div></div>

<ul>
  <li>Remove the version header.</li>
</ul>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;httpRuntime</span> <span class="na">enableVersionHeader=</span><span class="s">"false"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<ul>
  <li>Also remove the Server header.</li>
</ul>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">HttpContext</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="nf">Remove</span><span class="p">(</span><span class="s">"Server"</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="http-validation-and-encoding">HTTP validation and encoding</h2>

<ul>
  <li>Do not disable <a href="http://www.asp.net/whitepapers/request-validation">validateRequest</a> in the <code class="language-plaintext highlighter-rouge">web.config</code> or the page setup. This value enables limited XSS protection in ASP.NET and should be left intact as it provides partial prevention of Cross Site Scripting. Complete request validation is recommended in addition to the built in protections.</li>
  <li>The 4.5 version of the .NET Frameworks includes the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.security.antixss.antixssencoder?view=netframework-4.7.2">AntiXssEncoder</a> library, which has a comprehensive input encoding library for the prevention of XSS. Use it.</li>
  <li>Whitelist allowable values anytime user input is accepted.</li>
  <li>Validate the URI format using <a href="http://msdn.microsoft.com/en-us/library/system.uri.iswellformeduristring.aspx">Uri.IsWellFormedUriString</a>.</li>
</ul>

<h2 id="forms-authentication">Forms authentication</h2>

<ul>
  <li>Use cookies for persistence when possible. <code class="language-plaintext highlighter-rouge">Cookieless</code> auth will default to <a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.httpcookiemode?view=netframework-4.7.2">UseDeviceProfile</a>.</li>
  <li>Don’t trust the URI of the request for persistence of the session or authorization. It can be easily faked.</li>
  <li>Reduce the forms authentication timeout from the default of <em>20 minutes</em> to the shortest period appropriate for your application. If <a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.security.formsauthentication.slidingexpiration?view=netframework-4.7.2">slidingExpiration</a> is used this timeout resets after each request, so active users won’t be affected.</li>
  <li>If HTTPS is not used, <a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.security.formsauthentication.slidingexpiration?view=netframework-4.7.2">slidingExpiration</a> should be disabled. Consider disabling <a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.security.formsauthentication.slidingexpiration?view=netframework-4.7.2">slidingExpiration</a> even with HTTPS.</li>
  <li>Always implement proper access controls.
    <ul>
      <li>Compare user provided username with <code class="language-plaintext highlighter-rouge">User.Identity.Name</code>.</li>
      <li>Check roles against <code class="language-plaintext highlighter-rouge">User.Identity.IsInRole</code>.</li>
    </ul>
  </li>
  <li>Use the <a href="https://docs.microsoft.com/en-us/dotnet/framework/wcf/samples/membership-and-role-provider">ASP.NET Membership provider and role provider</a>, but review the password storage. The default storage hashes the password with a single iteration of SHA-1 which is rather weak. The ASP.NET MVC4 template uses <a href="http://www.asp.net/identity/overview/getting-started/introduction-to-aspnet-identity">ASP.NET Identity</a> instead of ASP.NET Membership, and ASP.NET Identity uses PBKDF2 by default which is better. Review the OWASP <a href="/cheatsheets/Password_Storage_Cheat_Sheet.html">Password Storage Cheat Sheet</a> for more information.</li>
  <li>Explicitly authorize resource requests.</li>
  <li>Leverage role based authorization using <code class="language-plaintext highlighter-rouge">User.Identity.IsInRole</code>.</li>
</ul>

<h1 id="asp-net-mvc-guidance">ASP NET MVC Guidance</h1>

<p>ASP.NET MVC (Model–View–Controller) is a contemporary web application framework that uses more standardized HTTP communication than the Web Forms postback model.</p>

<p>The OWASP Top 10 2017 lists the most prevalent and dangerous threats to web security in the world today and is reviewed every 3 years.</p>

<p>This section is based on this. Your approach to securing your web application should be to start at the top threat A1 below and work down, this will ensure that any time spent on security will be spent most effectively spent and cover the top threats first and lesser threats afterwards. After covering the top 10 it is generally advisable to assess for other threats or get a professionally completed Penetration Test.</p>

<h2 id="a1-injection">A1 Injection</h2>

<h3 id="sql-injection">SQL Injection</h3>

<p>DO: Using an object relational mapper (ORM) or stored procedures is the most effective way of countering the SQL Injection vulnerability.</p>

<p>DO: Use parameterized queries where a direct sql query must be used. More Information can be found <a href="/cheatsheets/Query_Parameterization_Cheat_Sheet.html">here</a>.</p>

<p>e.g. In entity frameworks:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">var</span><span class="err"> </span><span class="k">sql</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="o">@</span><span class="nv">"Update [User] SET FirstName = @FirstName WHERE Id = @Id"</span><span class="p">;</span>
<span class="n">context</span><span class="p">.</span><span class="k">Database</span><span class="p">.</span><span class="n">ExecuteSqlCommand</span><span class="p">(</span>
    <span class="k">sql</span><span class="p">,</span>
    <span class="k">new</span><span class="err"> </span><span class="n">SqlParameter</span><span class="p">(</span><span class="nv">"@FirstName"</span><span class="p">,</span><span class="err"> </span><span class="n">firstname</span><span class="p">),</span>
    <span class="k">new</span><span class="err"> </span><span class="n">SqlParameter</span><span class="p">(</span><span class="nv">"@Id"</span><span class="p">,</span><span class="err"> </span><span class="n">id</span><span class="p">));</span>
</code></pre></div></div>

<p>DO NOT: Concatenate strings anywhere in your code and execute them against your database (Known as dynamic sql).</p>

<p>NB: You can still accidentally do this with ORMs or Stored procedures so check everywhere.</p>

<p>e.g</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">string</span><span class="err"> </span><span class="n">strQry</span><span class="err"> </span><span class="o">=</span><span class="err"> </span><span class="nv">"SELECT * FROM Users WHERE UserName='"</span><span class="err"> </span><span class="o">+</span><span class="err"> </span><span class="n">txtUser</span><span class="p">.</span><span class="nb">Text</span><span class="err"> </span><span class="o">+</span><span class="err"> </span><span class="nv">"' AND Password='"</span><span class="err"> </span>
                <span class="o">+</span><span class="err"> </span><span class="n">txtPassword</span><span class="p">.</span><span class="nb">Text</span><span class="err"> </span><span class="o">+</span><span class="err"> </span><span class="nv">"'"</span><span class="p">;</span>
<span class="k">EXEC</span><span class="err"> </span><span class="n">strQry</span><span class="err"> </span><span class="o">//</span><span class="err"> </span><span class="k">SQL</span><span class="err"> </span><span class="n">Injection</span><span class="err"> </span><span class="n">vulnerability</span><span class="o">!</span>
</code></pre></div></div>

<p>DO: Practise Least Privilege - Connect to the database using an account with a minimum set of permissions required to do it’s job i.e. not the sa account</p>

<h3 id="os-injection">OS Injection</h3>

<p>Information about OS Injection can be found on this <a href="/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html#net">cheat sheet</a>.</p>

<p>DO: Use <a href="https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.process.start?view=netframework-4.7.2">System.Diagnostics.Process.Start</a> to call underlying OS functions.</p>

<p>e.g</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">System</span><span class="p">.</span><span class="n">Diagnostics</span><span class="p">.</span><span class="n">Process</span> <span class="n">process</span> <span class="p">=</span> <span class="k">new</span> <span class="n">System</span><span class="p">.</span><span class="n">Diagnostics</span><span class="p">.</span><span class="nf">Process</span><span class="p">();</span>
<span class="n">System</span><span class="p">.</span><span class="n">Diagnostics</span><span class="p">.</span><span class="n">ProcessStartInfo</span> <span class="n">startInfo</span> <span class="p">=</span> <span class="k">new</span> <span class="n">System</span><span class="p">.</span><span class="n">Diagnostics</span><span class="p">.</span><span class="nf">ProcessStartInfo</span><span class="p">();</span>
<span class="n">startInfo</span><span class="p">.</span><span class="n">FileName</span> <span class="p">=</span> <span class="s">"validatedCommand"</span><span class="p">;</span>
<span class="n">startInfo</span><span class="p">.</span><span class="n">Arguments</span> <span class="p">=</span> <span class="s">"validatedArg1 validatedArg2 validatedArg3"</span><span class="p">;</span>
<span class="n">process</span><span class="p">.</span><span class="n">StartInfo</span> <span class="p">=</span> <span class="n">startInfo</span><span class="p">;</span>
<span class="n">process</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>
</code></pre></div></div>

<p>DO: Use whitelist validation on all user supplied input. Input validation prevents improperly formed data from entering an information system. For more information please see the <a href="/cheatsheets/Input_Validation_Cheat_Sheet.html">Input Validation Cheat Sheet</a>.</p>

<p>e.g Validating user input using <a href="https://docs.microsoft.com/en-us/dotnet/api/system.net.ipaddress.tryparse?view=netframework-4.8">IPAddress.TryParse Method</a></p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//User input</span>
<span class="kt">string</span> <span class="n">ipAddress</span> <span class="p">=</span> <span class="s">"127.0.0.1"</span><span class="p">;</span>
 
<span class="c1">//check to make sure an ip address was provided    </span>
<span class="k">if</span> <span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">ipAddress</span><span class="p">))</span>  
<span class="p">{</span>
	<span class="c1">// Create an instance of IPAddress for the specified address string (in </span>
	<span class="c1">// dotted-quad, or colon-hexadecimal notation).</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">IPAddress</span><span class="p">.</span><span class="nf">TryParse</span><span class="p">(</span><span class="n">ipAddress</span><span class="p">,</span> <span class="k">out</span> <span class="kt">var</span> <span class="n">address</span><span class="p">))</span>
	<span class="p">{</span>
		<span class="c1">// Display the address in standard notation.</span>
		<span class="k">return</span> <span class="n">address</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>
	<span class="p">}</span>
	<span class="k">else</span>
	<span class="p">{</span>
		<span class="c1">//ipAddress is not of type IPAddress</span>
		<span class="p">...</span>
	<span class="p">}</span>
    <span class="p">...</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="ldap-injection">LDAP injection</h3>

<p>Almost any characters can be used in Distinguished Names. However, some must be escaped with the backslash <code class="language-plaintext highlighter-rouge">\</code> escape character. A table showing which characters that should be escaped for Active Directory can be found at the in the <a href="/cheatsheets/LDAP_Injection_Prevention_Cheat_Sheet.html#introduction">LDAP Injection Prevention Cheat Sheet</a>.</p>

<p>NB: The space character must be escaped only if it is the leading or trailing character in a component name, such as a Common Name. Embedded spaces should not be escaped.</p>

<p>More information can be found <a href="/cheatsheets/LDAP_Injection_Prevention_Cheat_Sheet.html#introduction">here</a>.</p>

<h2 id="a2-broken-authentication">A2 Broken Authentication</h2>

<p>DO: Use <a href="https://docs.microsoft.com/en-us/aspnet/core/security/authentication/identity?view=aspnetcore-2.2&amp;">ASP.net Core Identity</a>.
ASP.net Core Identity framework is well configured by default, where it uses secure password hashes and an individual salt. Identity uses the PBKDF2 hashing function for passwords, and they generate a random salt per user.</p>

<p>DO: Set secure password policy</p>

<p>e.g ASP.net Core Identity</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//startup.cs</span>
<span class="n">services</span><span class="p">.</span><span class="n">Configure</span><span class="p">&lt;</span><span class="n">IdentityOptions</span><span class="p">&gt;(</span><span class="n">options</span> <span class="p">=&gt;</span>
<span class="p">{</span>
	<span class="c1">// Password settings</span>
	<span class="n">options</span><span class="p">.</span><span class="n">Password</span><span class="p">.</span><span class="n">RequireDigit</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
	<span class="n">options</span><span class="p">.</span><span class="n">Password</span><span class="p">.</span><span class="n">RequiredLength</span> <span class="p">=</span> <span class="m">8</span><span class="p">;</span>
	<span class="n">options</span><span class="p">.</span><span class="n">Password</span><span class="p">.</span><span class="n">RequireNonAlphanumeric</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
	<span class="n">options</span><span class="p">.</span><span class="n">Password</span><span class="p">.</span><span class="n">RequireUppercase</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
	<span class="n">options</span><span class="p">.</span><span class="n">Password</span><span class="p">.</span><span class="n">RequireLowercase</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
	<span class="n">options</span><span class="p">.</span><span class="n">Password</span><span class="p">.</span><span class="n">RequiredUniqueChars</span> <span class="p">=</span> <span class="m">6</span><span class="p">;</span>
 
 
	<span class="n">options</span><span class="p">.</span><span class="n">Lockout</span><span class="p">.</span><span class="n">DefaultLockoutTimeSpan</span> <span class="p">=</span> <span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromMinutes</span><span class="p">(</span><span class="m">30</span><span class="p">);</span>
	<span class="n">options</span><span class="p">.</span><span class="n">Lockout</span><span class="p">.</span><span class="n">MaxFailedAccessAttempts</span> <span class="p">=</span> <span class="m">3</span><span class="p">;</span>
 
	<span class="n">options</span><span class="p">.</span><span class="n">SignIn</span><span class="p">.</span><span class="n">RequireConfirmedEmail</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
	
	<span class="n">options</span><span class="p">.</span><span class="n">User</span><span class="p">.</span><span class="n">RequireUniqueEmail</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
<span class="p">});</span>
</code></pre></div></div>

<p>DO: Set a cookie policy</p>

<p>e.g</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//startup.cs</span>
<span class="n">services</span><span class="p">.</span><span class="nf">ConfigureApplicationCookie</span><span class="p">(</span><span class="n">options</span> <span class="p">=&gt;</span>
<span class="p">{</span>
	<span class="n">options</span><span class="p">.</span><span class="n">Cookie</span><span class="p">.</span><span class="n">HttpOnly</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
	<span class="n">options</span><span class="p">.</span><span class="n">Cookie</span><span class="p">.</span><span class="n">Expiration</span> <span class="p">=</span> <span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromHours</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
	<span class="n">options</span><span class="p">.</span><span class="n">SlidingExpiration</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
<span class="p">});</span>
</code></pre></div></div>

<h2 id="a3-sensitive-data-exposure">A3 Sensitive Data Exposure</h2>

<p>DO NOT: <a href="/cheatsheets/Password_Storage_Cheat_Sheet.html#do-not-limit-the-character-set-and-set-long-max-lengths-for-credentials">Store encrypted passwords</a>.</p>

<p>DO: Use a strong hash to store password credentials. For hash refer to <a href="/cheatsheets/Password_Storage_Cheat_Sheet.html#guidance">this section</a>.</p>

<p>DO: Enforce passwords with a minimum complexity that will survive a dictionary attack i.e. longer passwords that use the full character set (numbers, symbols and letters) to increase the entropy.</p>

<p>DO: Use a strong encryption routine such as AES-512 where personally identifiable data needs to be restored to it’s original format. Protect encryption keys more than any other asset, please find <a href="/cheatsheets/Password_Storage_Cheat_Sheet.html#guidance">more information of storing encryption keys at rest</a>.
Apply the following test: Would you be happy leaving the data on a spreadsheet on a bus for everyone to read. Assume the attacker can get direct access to your database and protect it accordingly. More information can be found <a href="/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html">here</a>.</p>

<p>DO: Use TLS 1.2 for your entire site. Get a free certificate <a href="https://letsencrypt.org/">LetsEncrypt.org</a>.</p>

<p>DO NOT: <a href="https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices#22-use-secure-protocols">Allow SSL, this is now obsolete</a>.</p>

<p>DO: Have a strong TLS policy (see <a href="http://www.ssllabs.com/projects/best-practises/">SSL Best Practises</a>), use TLS 1.2 wherever possible. Then check the configuration using <a href="https://www.ssllabs.com/ssltest/">SSL Test</a> or <a href="https://testssl.sh/">TestSSL</a>.</p>

<p>DO: Ensure headers are not disclosing information about your application. See <a href="https://github.com/johnstaveley/SecurityEssentials/blob/master/SecurityEssentials/Core/HttpHeaders.cs">HttpHeaders.cs</a> , <a href="https://github.com/Dionach/StripHeaders/">Dionach StripHeaders</a>, disable via <code class="language-plaintext highlighter-rouge">web.config</code> or <a href="https://medium.com/bugbountywriteup/security-headers-1c770105940b">startup.cs</a>:</p>

<p>More information on Transport Layer Protection can be found <a href="/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html">here</a>.
e.g Web.config</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;system.web&gt;</span>
    <span class="nt">&lt;httpRuntime</span> <span class="na">enableVersionHeader=</span><span class="s">"false"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/system.web&gt;</span>
<span class="nt">&lt;system.webServer&gt;</span>
    <span class="nt">&lt;security&gt;</span>
        <span class="nt">&lt;requestFiltering</span> <span class="na">removeServerHeader=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/security&gt;</span>
    <span class="nt">&lt;httpProtocol&gt;</span>
        <span class="nt">&lt;customHeaders&gt;</span>
            <span class="nt">&lt;add</span> <span class="na">name=</span><span class="s">"X-Content-Type-Options"</span> <span class="na">value=</span><span class="s">"nosniff"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;add</span> <span class="na">name=</span><span class="s">"X-Frame-Options"</span> <span class="na">value=</span><span class="s">"DENY"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;add</span> <span class="na">name=</span><span class="s">"X-Permitted-Cross-Domain-Policies"</span> <span class="na">value=</span><span class="s">"master-only"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;add</span> <span class="na">name=</span><span class="s">"X-XSS-Protection"</span> <span class="na">value=</span><span class="s">"1; mode=block"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;remove</span> <span class="na">name=</span><span class="s">"X-Powered-By"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/customHeaders&gt;</span>
    <span class="nt">&lt;/httpProtocol&gt;</span>
<span class="nt">&lt;/system.webServer&gt;</span>    
</code></pre></div></div>

<p>e.g Startup.cs</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="nf">UseHsts</span><span class="p">(</span><span class="n">hsts</span> <span class="p">=&gt;</span> <span class="n">hsts</span><span class="p">.</span><span class="nf">MaxAge</span><span class="p">(</span><span class="m">365</span><span class="p">).</span><span class="nf">IncludeSubdomains</span><span class="p">());</span>
<span class="n">app</span><span class="p">.</span><span class="nf">UseXContentTypeOptions</span><span class="p">();</span>
<span class="n">app</span><span class="p">.</span><span class="nf">UseReferrerPolicy</span><span class="p">(</span><span class="n">opts</span> <span class="p">=&gt;</span> <span class="n">opts</span><span class="p">.</span><span class="nf">NoReferrer</span><span class="p">());</span>
<span class="n">app</span><span class="p">.</span><span class="nf">UseXXssProtection</span><span class="p">(</span><span class="n">options</span> <span class="p">=&gt;</span> <span class="n">options</span><span class="p">.</span><span class="nf">EnabledWithBlockMode</span><span class="p">());</span>
<span class="n">app</span><span class="p">.</span><span class="nf">UseXfo</span><span class="p">(</span><span class="n">options</span> <span class="p">=&gt;</span> <span class="n">options</span><span class="p">.</span><span class="nf">Deny</span><span class="p">());</span>

<span class="n">app</span><span class="p">.</span><span class="nf">UseCsp</span><span class="p">(</span><span class="n">opts</span> <span class="p">=&gt;</span> <span class="n">opts</span>
 <span class="p">.</span><span class="nf">BlockAllMixedContent</span><span class="p">()</span>
 <span class="p">.</span><span class="nf">StyleSources</span><span class="p">(</span><span class="n">s</span> <span class="p">=&gt;</span> <span class="n">s</span><span class="p">.</span><span class="nf">Self</span><span class="p">())</span>
 <span class="p">.</span><span class="nf">StyleSources</span><span class="p">(</span><span class="n">s</span> <span class="p">=&gt;</span> <span class="n">s</span><span class="p">.</span><span class="nf">UnsafeInline</span><span class="p">())</span>
 <span class="p">.</span><span class="nf">FontSources</span><span class="p">(</span><span class="n">s</span> <span class="p">=&gt;</span> <span class="n">s</span><span class="p">.</span><span class="nf">Self</span><span class="p">())</span>
 <span class="p">.</span><span class="nf">FormActions</span><span class="p">(</span><span class="n">s</span> <span class="p">=&gt;</span> <span class="n">s</span><span class="p">.</span><span class="nf">Self</span><span class="p">())</span>
 <span class="p">.</span><span class="nf">FrameAncestors</span><span class="p">(</span><span class="n">s</span> <span class="p">=&gt;</span> <span class="n">s</span><span class="p">.</span><span class="nf">Self</span><span class="p">())</span>
 <span class="p">.</span><span class="nf">ImageSources</span><span class="p">(</span><span class="n">s</span> <span class="p">=&gt;</span> <span class="n">s</span><span class="p">.</span><span class="nf">Self</span><span class="p">())</span>
 <span class="p">.</span><span class="nf">ScriptSources</span><span class="p">(</span><span class="n">s</span> <span class="p">=&gt;</span> <span class="n">s</span><span class="p">.</span><span class="nf">Self</span><span class="p">())</span>
 <span class="p">);</span>
</code></pre></div></div>

<p>For more information about headers can be found <a href="https://www.owasp.org/index.php/OWASP_Secure_Headers_Project#xpcdp">here</a>.</p>

<h2 id="a4-xml-external-entities-xxe">A4 XML External Entities (XXE)</h2>

<p>Please refer to the XXE cheat sheet so more detailed information, which can be found <a href="/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html#net">here</a>.</p>

<p>XXE attacks occur when an XML parse does not properly process user input that contains external entity declaration in the doctype of an XML payload.</p>

<p>Below are the three most common <a href="https://docs.microsoft.com/en-us/dotnet/standard/data/xml/xml-processing-options">XML Processing Options</a> for .NET.</p>

<h2 id="a5-broken-access-control">A5 Broken Access Control</h2>

<h3 id="weak-account-management">Weak Account management</h3>

<p>Ensure cookies are sent via httpOnly:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">CookieHttpOnly</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="k">true</span><span class="p">,</span>
</code></pre></div></div>

<p>Reduce the time period a session can be stolen in by reducing session timeout and removing sliding expiration:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ExpireTimeSpan</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromMinutes</span><span class="p">(</span><span class="m">60</span><span class="p">),</span>
<span class="n">SlidingExpiration</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="k">false</span>
</code></pre></div></div>

<p>See <a href="https://github.com/johnstaveley/SecurityEssentials/blob/master/SecurityEssentials/App_Start/Startup.Auth.cs">here</a> for full startup code snippet</p>

<p>Ensure cookie is sent over https in the production environment. This should be enforced in the config transforms:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;httpCookies</span> <span class="na">requireSSL=</span><span class="s">"true"</span> <span class="na">xdt:Transform=</span><span class="s">"SetAttributes(requireSSL)"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;authentication&gt;</span>
    <span class="nt">&lt;forms</span> <span class="na">requireSSL=</span><span class="s">"true"</span> <span class="na">xdt:Transform=</span><span class="s">"SetAttributes(requireSSL)"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/authentication&gt;</span>
</code></pre></div></div>

<p>Protect LogOn, Registration and password reset methods against brute force attacks by throttling requests (see code below), consider also using ReCaptcha.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">HttpPost</span><span class="p">]</span>
<span class="p">[</span><span class="n">AllowAnonymous</span><span class="p">]</span>
<span class="p">[</span><span class="n">ValidateAntiForgeryToken</span><span class="p">]</span>
<span class="p">[</span><span class="nf">AllowXRequestsEveryXSecondsAttribute</span><span class="p">(</span><span class="n">Name</span> <span class="p">=</span> <span class="s">"LogOn"</span><span class="p">,</span> 
<span class="n">Message</span> <span class="p">=</span> <span class="s">"You have performed this action more than {x} times in the last {n} seconds."</span><span class="p">,</span> 
<span class="n">Requests</span> <span class="p">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">Seconds</span> <span class="p">=</span> <span class="m">60</span><span class="p">)]</span>
<span class="k">public</span><span class="err"> </span><span class="k">async</span><span class="err"> </span><span class="n">Task</span><span class="p">&lt;</span><span class="n">ActionResult</span><span class="p">&gt;</span><span class="err"> </span><span class="nf">LogOn</span><span class="p">(</span><span class="n">LogOnViewModel</span><span class="err"> </span><span class="n">model</span><span class="p">,</span><span class="err"> </span><span class="kt">string</span><span class="err"> </span><span class="n">returnUrl</span><span class="p">)</span>
</code></pre></div></div>

<p>DO NOT: Roll your own authentication or session management, use the one provided by .Net</p>

<p>DO NOT: Tell someone if the account exists on LogOn, Registration or Password reset. Say something like ‘Either the username or password was incorrect’, or ‘If this account exists then a reset token will be sent to the registered email address’. This protects against account enumeration.</p>

<p>The feedback to the user should be identical whether or not the account exists, both in terms of content and behavior: e.g. if the response takes 50% longer when the account is real then membership information can be guessed and tested.</p>

<h3 id="missing-function-level-access-control">Missing function-level access control</h3>

<p>DO: Authorize users on all externally facing endpoints. The .NET framework has many ways to authorize a user, use them at method level:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="nf">Authorize</span><span class="p">(</span><span class="n">Roles</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="s">"Admin"</span><span class="p">)]</span>
<span class="p">[</span><span class="n">HttpGet</span><span class="p">]</span>
<span class="k">public</span><span class="err"> </span><span class="n">ActionResult</span><span class="err"> </span><span class="nf">Index</span><span class="p">(</span><span class="kt">int</span><span class="err"> </span><span class="n">page</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="m">1</span><span class="p">)</span>
</code></pre></div></div>

<p>or better yet, at controller level:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">Authorize</span><span class="p">]</span>
<span class="k">public</span><span class="err"> </span><span class="k">class</span><span class="err"> </span><span class="nc">UserController</span>
</code></pre></div></div>

<p>You can also check roles in code using identity features in .net: <code class="language-plaintext highlighter-rouge">System.Web.Security.Roles.IsUserInRole(userName, roleName)</code></p>

<p>You can find more information <a href="/cheatsheets/Access_Control_Cheat_Sheet.html#introduction">here</a> on Access Control and <a href="/cheatsheets/Authorization_Testing_Automation.html">here</a> for Authorization.</p>

<h3 id="insecure-direct-object-references">Insecure Direct object references</h3>

<p>When you have a resource (object) which can be accessed by a reference (in the sample below this is the <code class="language-plaintext highlighter-rouge">id</code>) then you need to ensure that the user is intended to be there</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Insecure</span>
<span class="k">public</span><span class="err"> </span><span class="n">ActionResult</span><span class="err"> </span><span class="nf">Edit</span><span class="p">(</span><span class="kt">int</span><span class="err"> </span><span class="n">id</span><span class="p">)</span>
<span class="p">{</span>
<span class="err">  </span><span class="kt">var</span><span class="err"> </span><span class="n">user</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="n">_context</span><span class="p">.</span><span class="n">Users</span><span class="p">.</span><span class="nf">FirstOrDefault</span><span class="p">(</span><span class="n">e</span><span class="err"> </span><span class="p">=&gt;</span><span class="err"> </span><span class="n">e</span><span class="p">.</span><span class="n">Id</span><span class="err"> </span><span class="p">==</span><span class="err"> </span><span class="n">id</span><span class="p">);</span>
<span class="err">  </span><span class="k">return</span><span class="err"> </span><span class="nf">View</span><span class="p">(</span><span class="s">"Details"</span><span class="p">,</span><span class="err"> </span><span class="k">new</span><span class="err"> </span><span class="nf">UserViewModel</span><span class="p">(</span><span class="n">user</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Secure</span>
<span class="k">public</span><span class="err"> </span><span class="n">ActionResult</span><span class="err"> </span><span class="nf">Edit</span><span class="p">(</span><span class="kt">int</span><span class="err"> </span><span class="n">id</span><span class="p">)</span>
<span class="p">{</span>
<span class="err">  </span><span class="kt">var</span><span class="err"> </span><span class="n">user</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="n">_context</span><span class="p">.</span><span class="n">Users</span><span class="p">.</span><span class="nf">FirstOrDefault</span><span class="p">(</span><span class="n">e</span><span class="err"> </span><span class="p">=&gt;</span><span class="err"> </span><span class="n">e</span><span class="p">.</span><span class="n">Id</span><span class="err"> </span><span class="p">==</span><span class="err"> </span><span class="n">id</span><span class="p">);</span>
<span class="err">  </span><span class="c1">// Establish user has right to edit the details</span>
<span class="err">  </span><span class="k">if</span><span class="err"> </span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">Id</span><span class="err"> </span><span class="p">!=</span><span class="err"> </span><span class="n">_userIdentity</span><span class="p">.</span><span class="nf">GetUserId</span><span class="p">())</span>
<span class="err">  </span><span class="p">{</span>
        <span class="n">HandleErrorInfo</span><span class="err"> </span><span class="n">error</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="k">new</span><span class="err"> </span><span class="nf">HandleErrorInfo</span><span class="p">(</span>
            <span class="k">new</span><span class="err"> </span><span class="nf">Exception</span><span class="p">(</span><span class="s">"INFO: You do not have permission to edit these details"</span><span class="p">));</span>
        <span class="k">return</span><span class="err"> </span><span class="nf">View</span><span class="p">(</span><span class="s">"Error"</span><span class="p">,</span><span class="err"> </span><span class="n">error</span><span class="p">);</span>
<span class="err">  </span><span class="p">}</span>
  <span class="k">return</span><span class="err"> </span><span class="nf">View</span><span class="p">(</span><span class="s">"Edit"</span><span class="p">,</span><span class="err"> </span><span class="k">new</span><span class="err"> </span><span class="nf">UserViewModel</span><span class="p">(</span><span class="n">user</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>More information can be found <a href="/cheatsheets/Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html">here</a> for Insecure Direct Object Reference.</p>

<h2 id="a6-security-misconfiguration">A6 Security Misconfiguration</h2>

<h3 id="debug-and-stack-trace">Debug and Stack Trace</h3>

<p>Ensure debug and trace are off in production. This can be enforced using web.config transforms:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;compilation</span> <span class="na">xdt:Transform=</span><span class="s">"RemoveAttributes(debug)"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;trace</span> <span class="na">enabled=</span><span class="s">"false"</span> <span class="na">xdt:Transform=</span><span class="s">"Replace"</span><span class="nt">/&gt;</span>
</code></pre></div></div>

<p>DO NOT: Use default passwords</p>

<p>DO: (When using TLS) Redirect a request made over Http to https:</p>

<p>e.g Global.asax.cs</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">protected</span><span class="err"> </span><span class="k">void</span><span class="err"> </span><span class="nf">Application_BeginRequest</span><span class="p">()</span>
<span class="p">{</span>
    <span class="err">#</span><span class="k">if</span><span class="err"> </span><span class="p">!</span><span class="n">DEBUG</span>
    <span class="c1">// SECURE: Ensure any request is returned over SSL/TLS in production</span>
    <span class="k">if</span><span class="err"> </span><span class="p">(!</span><span class="n">Request</span><span class="p">.</span><span class="n">IsLocal</span><span class="err"> </span><span class="p">&amp;&amp;</span><span class="err"> </span><span class="p">!</span><span class="n">Context</span><span class="p">.</span><span class="n">Request</span><span class="p">.</span><span class="n">IsSecureConnection</span><span class="p">)</span><span class="err"> </span><span class="p">{</span>
        <span class="kt">var</span><span class="err"> </span><span class="n">redirect</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="n">Context</span><span class="p">.</span><span class="n">Request</span><span class="p">.</span><span class="n">Url</span><span class="p">.</span><span class="nf">ToString</span><span class="p">()</span>
                        <span class="p">.</span><span class="nf">ToLower</span><span class="p">(</span><span class="n">CultureInfo</span><span class="p">.</span><span class="n">CurrentCulture</span><span class="p">)</span>
                        <span class="p">.</span><span class="nf">Replace</span><span class="p">(</span><span class="s">"http:"</span><span class="p">,</span><span class="err"> </span><span class="s">"https:"</span><span class="p">);</span>
        <span class="n">Response</span><span class="p">.</span><span class="nf">Redirect</span><span class="p">(</span><span class="n">redirect</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="err">#</span><span class="n">endif</span>
<span class="p">}</span>
</code></pre></div></div>

<p>e.g Startup.cs in the Configure()</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">app</span><span class="p">.</span><span class="nf">UseHttpsRedirection</span><span class="p">();</span>
</code></pre></div></div>

<h3 id="cross-site-request-forgery">Cross-site request forgery</h3>

<p>DO NOT: Send sensitive data without validating Anti-Forgery-Tokens (<a href="https://docs.microsoft.com/en-us/aspnet/web-api/overview/security/preventing-cross-site-request-forgery-csrf-attacks">.NET</a> / <a href="https://docs.microsoft.com/en-us/aspnet/core/security/anti-request-forgery?view=aspnetcore-3.0#aspnet-core-antiforgery-configuration">.NET Core</a>).</p>

<p>DO: Send the anti-forgery token with every POST/PUT request:</p>

<h4 id="using-net-framework">Using .NET Framework:</h4>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="p">(</span><span class="n">Html</span><span class="p">.</span><span class="nf">BeginForm</span><span class="p">(</span><span class="s">"LogOff"</span><span class="p">,</span> <span class="s">"Account"</span><span class="p">,</span> <span class="n">FormMethod</span><span class="p">.</span><span class="n">Post</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">id</span> <span class="p">=</span> <span class="s">"logoutForm"</span><span class="p">,</span> 
                        <span class="n">@class</span> <span class="p">=</span> <span class="s">"pull-right"</span> <span class="p">}))</span>
<span class="p">{</span>
    <span class="n">@Html</span><span class="p">.</span><span class="nf">AntiForgeryToken</span><span class="p">()</span>
    <span class="p">&lt;</span><span class="n">ul</span> <span class="k">class</span><span class="err">="</span><span class="nc">nav</span> <span class="n">nav</span><span class="p">-</span><span class="n">pills</span><span class="s">"&gt;
</span>        <span class="p">&lt;</span><span class="n">li</span> <span class="n">role</span><span class="p">=</span><span class="s">"presentation"</span><span class="p">&gt;</span>
        <span class="n">Logged</span> <span class="k">on</span> <span class="k">as</span> <span class="n">@User</span><span class="p">.</span><span class="n">Identity</span><span class="p">.</span><span class="n">Name</span>
        <span class="p">&lt;/</span><span class="n">li</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="n">li</span> <span class="n">role</span><span class="p">=</span><span class="s">"presentation"</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="p">=</span><span class="s">"javascript:document.getElementById('logoutForm').submit()"</span><span class="p">&gt;</span><span class="n">Log</span> <span class="n">off</span><span class="p">&lt;/</span><span class="n">a</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="n">li</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="n">ul</span><span class="p">&gt;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Then validate it at the method or preferably the controller level:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">HttpPost</span><span class="p">]</span>
<span class="p">[</span><span class="n">ValidateAntiForgeryToken</span><span class="p">]</span>
<span class="k">public</span><span class="err"> </span><span class="n">ActionResult</span><span class="err"> </span><span class="nf">LogOff</span><span class="p">()</span>
</code></pre></div></div>

<p>Make sure the tokens are removed completely for invalidation on logout.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// SECURE: Remove any remaining cookies including Anti-CSRF cookie</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="k">public</span><span class="err"> </span><span class="k">void</span><span class="err"> </span><span class="nf">RemoveAntiForgeryCookie</span><span class="p">(</span><span class="n">Controller</span><span class="err"> </span><span class="n">controller</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">string</span><span class="p">[]</span><span class="err"> </span><span class="n">allCookies</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="n">controller</span><span class="p">.</span><span class="n">Request</span><span class="p">.</span><span class="n">Cookies</span><span class="p">.</span><span class="n">AllKeys</span><span class="p">;</span>
    <span class="k">foreach</span><span class="err"> </span><span class="p">(</span><span class="kt">string</span><span class="err"> </span><span class="n">cookie</span><span class="err"> </span><span class="k">in</span><span class="err"> </span><span class="n">allCookies</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="err"> </span><span class="p">(</span><span class="n">controller</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">Cookies</span><span class="p">[</span><span class="n">cookie</span><span class="p">]</span><span class="err"> </span><span class="p">!=</span><span class="err"> </span><span class="k">null</span><span class="err"> </span><span class="p">&amp;&amp;</span><span class="err"> </span>
            <span class="n">cookie</span><span class="err"> </span><span class="p">==</span><span class="err"> </span><span class="s">"__RequestVerificationToken"</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">controller</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">Cookies</span><span class="p">[</span><span class="n">cookie</span><span class="p">].</span><span class="n">Expires</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">.</span><span class="nf">AddDays</span><span class="p">(-</span><span class="m">1</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="using-net-core-20-or-later">Using .NET Core 2.0 or later:</h4>

<p>Starting with .NET Core 2.0 it is possible to <a href="https://docs.microsoft.com/en-us/aspnet/core/security/anti-request-forgery?view=aspnetcore-3.0#aspnet-core-antiforgery-configuration">automatically generate and verify the antiforgery token</a>.</p>

<p>If you are using <a href="https://docs.microsoft.com/en-us/aspnet/core/mvc/views/tag-helpers/intro">tag-helpers</a>, which is the default for most web project templates, then all forms will automatically send the anti-forgery token. You can check if tag-helpers are enabled by checking if your main <code class="language-plaintext highlighter-rouge">_ViewImports.cshtml</code> file contains:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">@addTagHelper</span> <span class="p">*,</span> <span class="n">Microsoft</span><span class="p">.</span><span class="n">AspNetCore</span><span class="p">.</span><span class="n">Mvc</span><span class="p">.</span><span class="n">TagHelpers</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">IHtmlHelper.BeginForm</code> also sends anti-forgery-tokens automatically.</p>

<p>Unless you are using tag-helpers or <code class="language-plaintext highlighter-rouge">IHtmlHelper.BeginForm</code>, you must use the requisite helper on forms as seen here:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"RelevantAction"</span> <span class="nt">&gt;</span>
@Html.AntiForgeryToken()
<span class="nt">&lt;/form&gt;</span>
</code></pre></div></div>

<p>To automatically validate all requests other than GET, HEAD, OPTIONS and TRACE you need to add a global action filter with the <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.autovalidateantiforgerytokenattribute?view=aspnetcore-2.2">AutoValidateAntiforgeryToken</a> attribute inside your <code class="language-plaintext highlighter-rouge">Startup.cs</code> as mentioned in the following <a href="https://andrewlock.net/automatically-validating-anti-forgery-tokens-in-asp-net-core-with-the-autovalidateantiforgerytokenattribute/">article</a>:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">services</span><span class="p">.</span><span class="nf">AddMvc</span><span class="p">(</span><span class="n">options</span> <span class="p">=&gt;</span>
<span class="p">{</span>
    <span class="n">options</span><span class="p">.</span><span class="n">Filters</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="nf">AutoValidateAntiforgeryTokenAttribute</span><span class="p">());</span>
<span class="p">});</span>
</code></pre></div></div>

<p>If you need to disable the attribute validation for a specific method on a controller you can add the <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.ignoreantiforgerytokenattribute?view=aspnetcore-2.2">IgnoreAntiforgeryToken</a> attribute to the controller method (for MVC controllers) or parent class (for Razor pages):</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">IgnoreAntiforgeryToken</span><span class="p">]</span>
<span class="p">[</span><span class="n">HttpDelete</span><span class="p">]</span>
<span class="k">public</span> <span class="n">IActionResult</span> <span class="nf">Delete</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">IgnoreAntiforgeryToken</span><span class="p">]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">UnsafeModel</span> <span class="p">:</span> <span class="n">PageModel</span>
</code></pre></div></div>

<p>If you need to also validate the token on GET, HEAD, OPTIONS or TRACE - requests you can add the <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.validateantiforgerytokenattribute?view=aspnetcore-2.2">ValidateAntiforgeryToken</a> attribute to the controller method (for MVC controllers) or parent class (for Razor pages):</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">HttpGet</span><span class="p">]</span>
<span class="p">[</span><span class="n">ValidateAntiforgeryToken</span><span class="p">]</span>
<span class="k">public</span> <span class="n">IActionResult</span> <span class="nf">DoSomethingDangerous</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">HttpGet</span><span class="p">]</span>
<span class="p">[</span><span class="n">ValidateAntiforgeryToken</span><span class="p">]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">SafeModel</span> <span class="p">:</span> <span class="n">PageModel</span>
</code></pre></div></div>

<p>In case you can’t use a global action filter, add the <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.autovalidateantiforgerytokenattribute?view=aspnetcore-2.2">AutoValidateAntiforgeryToken</a> attribute to your controller classes or razor page models:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">AutoValidateAntiforgeryToken</span><span class="p">]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">UserController</span>
</code></pre></div></div>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">AutoValidateAntiforgeryToken</span><span class="p">]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">SafeModel</span> <span class="p">:</span> <span class="n">PageModel</span>
</code></pre></div></div>

<h4 id="using-net-core-20-or-net-framework-with-ajax">Using .Net Core 2.0 or .NET Framework with AJAX</h4>

<p>You will need to attach the anti-forgery token to AJAX requests.</p>

<p>If you are using jQuery in an ASP.NET Core MVC view this can be achieved using this snippet:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">@</span><span class="nd">inject</span>  <span class="nx">Microsoft</span><span class="p">.</span><span class="nx">AspNetCore</span><span class="p">.</span><span class="nx">Antiforgery</span><span class="p">.</span><span class="nx">IAntiforgery</span> <span class="nx">antiforgeryProvider</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">(</span>
<span class="p">{</span>
    <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="dl">'</span><span class="s1">@Url.Action("Action", "Controller")</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">contentType</span><span class="p">:</span> <span class="dl">"</span><span class="s2">application/x-www-form-urlencoded; charset=utf-8</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="nx">id</span><span class="p">,</span>
        <span class="dl">'</span><span class="s1">__RequestVerificationToken</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">@antiforgeryProvider.GetAndStoreTokens(this.Context).RequestToken</span><span class="dl">'</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre></div></div>

<p>If you are using the .NET Framework, you can find some code snippets <a href="https://docs.microsoft.com/en-us/aspnet/web-api/overview/security/preventing-cross-site-request-forgery-csrf-attacks#anti-csrf-and-ajax">here</a>.</p>

<p>More information can be found <a href="/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html">here</a> for Cross-Site Request Forgery.</p>

<h2 id="a7-cross-site-scripting-xss">A7 Cross-Site Scripting (XSS)</h2>

<p>DO NOT: Trust any data the user sends you, prefer white lists (always safe) over black lists</p>

<p>You get encoding of all HTML content with MVC3, to properly encode all content whether HTML, javascript, CSS, LDAP etc use the Microsoft AntiXSS library:</p>

<p><code class="language-plaintext highlighter-rouge">Install-Package AntiXSS</code></p>

<p>Then set in config:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;system.web&gt;</span>
<span class="nt">&lt;httpRuntime</span> <span class="na">targetFramework=</span><span class="s">"4.5"</span> 
<span class="na">enableVersionHeader=</span><span class="s">"false"</span> 
<span class="na">encoderType=</span><span class="s">"Microsoft.Security.Application.AntiXssEncoder, AntiXssLibrary"</span> 
<span class="na">maxRequestLength=</span><span class="s">"4096"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<p>DO NOT: Use the <code class="language-plaintext highlighter-rouge">[AllowHTML]</code> attribute or helper class <code class="language-plaintext highlighter-rouge">@Html.Raw</code> unless you really know that the content you are writing to the browser is safe and has been escaped properly.</p>

<p>DO: Enable a <a href="/cheatsheets/Content_Security_Policy_Cheat_Sheet.html#context">Content Security Policy</a>, this will prevent your pages from accessing assets it should not be able to access (e.g. a malicious script):</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;system.webServer&gt;</span>
    <span class="nt">&lt;httpProtocol&gt;</span>
        <span class="nt">&lt;customHeaders&gt;</span>
            <span class="nt">&lt;add</span> <span class="na">name=</span><span class="s">"Content-Security-Policy"</span> 
                <span class="na">value=</span><span class="s">"default-src 'none'; style-src 'self'; img-src 'self'; 
                font-src 'self'; script-src 'self'"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<p>More information can be found <a href="/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html">here</a> for Cross-Site Scripting.</p>

<h2 id="a8-insecure-deserialization">A8 Insecure Deserialization</h2>

<p>Information about Insecure Deserialization can be found on this <a href="/cheatsheets/Deserialization_Cheat_Sheet.html#net-csharp">cheat sheet</a>.</p>

<p>DO NOT: Accept Serialized Objects from Untrusted Sources</p>

<p>DO: Validate User Input
Malicious users are able to use objects like cookies to insert malicious information to change user roles. In some cases, hackers are able to elevate their privileges to administrator rights by using a pre-existing or cached password hash from a previous session.</p>

<p>DO: Prevent Deserialization of Domain Objects</p>

<p>DO: Run the Deserialization Code with Limited Access Permissions
If a deserialized hostile object tries to initiate a system processes or access a resource within the server or the host’s OS, it will be denied access and a permission flag will be raised so that a system administrator is made aware of any anomalous activity on the server.</p>

<p>More information can be found here: <a href="/cheatsheets/Deserialization_Cheat_Sheet.html#net-csharp">Deserialization Cheat Sheet</a></p>

<h2 id="a9-using-components-with-known-vulnerabilities">A9 Using Components with Known Vulnerabilities</h2>

<p>DO: Keep the .Net framework updated with the latest patches</p>

<p>DO: Keep your <a href="https://docs.microsoft.com/en-us/nuget/">NuGet</a> packages up to date, many will contain their own vulnerabilities.</p>

<p>DO: Run the <a href="/cheatsheets/Vulnerable_Dependency_Management_Cheat_Sheet.html">OWASP Dependency Checker</a> against your application as part of your build process and act on any high level vulnerabilities.</p>

<h2 id="a10-insufficient-logging--monitoring">A10 Insufficient Logging &amp; Monitoring</h2>

<p>DO: Ensure all login, access control failures and server-side input validation failures can be logged with sufficient user context to identify suspicious or malicious accounts.</p>

<p>DO: Establish effective monitoring and alerting so suspicious activities are detected and responded to in a timely fashion.</p>

<p>DO NOT: Log generic error messages such as: <code class="language-plaintext highlighter-rouge">csharp Log.Error("Error was thrown");</code> rather log the stack trace, error message and user Id who caused the error.</p>

<p>DO NOT: Log sensitive data such as user’s passwords.</p>

<h3 id="logging">Logging</h3>

<p>What Logs to Collect and more information about Logging can be found on this <a href="/cheatsheets/Logging_Cheat_Sheet.html">cheat sheet</a>.</p>

<p>.NET Core come with a LoggerFactory, which is in Microsoft.Extensions.Logging. More information about ILogger can be found <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.extensions.logging.ilogger">here</a>.</p>

<p>How to log all errors from the <code class="language-plaintext highlighter-rouge">Startup.cs</code>, so that anytime an error is thrown it will be logged.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">void</span> <span class="nf">Configure</span><span class="p">(</span><span class="n">IApplicationBuilder</span> <span class="n">app</span><span class="p">,</span> <span class="n">IHostingEnvironment</span> <span class="n">env</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">env</span><span class="p">.</span><span class="nf">IsDevelopment</span><span class="p">())</span>
	<span class="p">{</span>
		<span class="n">_isDevelopment</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
		<span class="n">app</span><span class="p">.</span><span class="nf">UseDeveloperExceptionPage</span><span class="p">();</span>
	<span class="p">}</span>
	
	<span class="c1">//Log all errors in the application</span>
	<span class="n">app</span><span class="p">.</span><span class="nf">UseExceptionHandler</span><span class="p">(</span><span class="n">errorApp</span> <span class="p">=&gt;</span>
	<span class="p">{</span>
		<span class="n">errorApp</span><span class="p">.</span><span class="nf">Run</span><span class="p">(</span><span class="k">async</span> <span class="n">context</span> <span class="p">=&gt;</span>
		<span class="p">{</span>
		    <span class="kt">var</span> <span class="n">errorFeature</span> <span class="p">=</span> <span class="n">context</span><span class="p">.</span><span class="n">Features</span><span class="p">.</span><span class="n">Get</span><span class="p">&lt;</span><span class="n">IExceptionHandlerFeature</span><span class="p">&gt;();</span>
		    <span class="kt">var</span> <span class="n">exception</span> <span class="p">=</span> <span class="n">errorFeature</span><span class="p">.</span><span class="n">Error</span><span class="p">;</span>
		    
		    <span class="n">Log</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">"Stacktrace of error: {0}"</span><span class="p">,</span><span class="n">exception</span><span class="p">.</span><span class="n">StackTrace</span><span class="p">.</span><span class="nf">ToString</span><span class="p">()));</span>
		<span class="p">});</span>
	<span class="p">});</span>

        <span class="n">app</span><span class="p">.</span><span class="nf">UseAuthentication</span><span class="p">();</span>
            <span class="n">app</span><span class="p">.</span><span class="nf">UseMvc</span><span class="p">();</span>
        <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>e.g Injecting into the class constructor, which makes writing unit test simpler. It is recommended if instances of the class will be created using dependency injection (e.g. MVC controllers).  The below example shows logging of all unsuccessful log in attempts.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">AccountsController</span> <span class="p">:</span> <span class="n">Controller</span>
<span class="p">{</span>
        <span class="k">private</span> <span class="n">ILogger</span> <span class="n">_Logger</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">AccountsController</span><span class="p">(</span> <span class="n">ILogger</span> <span class="n">logger</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">_Logger</span> <span class="p">=</span> <span class="n">logger</span><span class="p">;</span>
        <span class="p">}</span>

	<span class="p">[</span><span class="n">HttpPost</span><span class="p">]</span>
        <span class="p">[</span><span class="n">AllowAnonymous</span><span class="p">]</span>
        <span class="p">[</span><span class="n">ValidateAntiForgeryToken</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">IActionResult</span><span class="p">&gt;</span> <span class="nf">Login</span><span class="p">(</span><span class="n">LoginViewModel</span> <span class="n">model</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ModelState</span><span class="p">.</span><span class="n">IsValid</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_signInManager</span><span class="p">.</span><span class="nf">PasswordSignInAsync</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">Email</span><span class="p">,</span> <span class="n">model</span><span class="p">.</span><span class="n">Password</span><span class="p">,</span> <span class="n">model</span><span class="p">.</span><span class="n">RememberMe</span><span class="p">,</span> <span class="n">lockoutOnFailure</span><span class="p">:</span> <span class="k">false</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">Succeeded</span><span class="p">)</span>
                <span class="p">{</span>
			<span class="c1">//Log all successful log in attempts</span>
			<span class="n">Log</span><span class="p">.</span><span class="nf">Information</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">"User: {0}, Successfully Logged in"</span><span class="p">,</span> <span class="n">model</span><span class="p">.</span><span class="n">Email</span><span class="p">));</span>
			<span class="c1">//Code for successful login</span>
		<span class="p">}</span>
		<span class="k">else</span>
		<span class="p">{</span>
			<span class="c1">//Log all incorrect log in attempts</span>
			<span class="n">Log</span><span class="p">.</span><span class="nf">Information</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">"User: {0}, Incorrect Password"</span><span class="p">,</span> <span class="n">model</span><span class="p">.</span><span class="n">Email</span><span class="p">));</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	<span class="p">...</span>
</code></pre></div></div>

<p>Logging levels for ILogger are listed below, in order of high to low importance:</p>

<h3 id="monitoring">Monitoring</h3>

<p>Monitoring allow us to validate the performance and health of a running system through key performance indicators.</p>

<p>In .NET a great option to add monitoring capabilities is <a href="https://docs.microsoft.com/en-us/azure/application-insights/app-insights-asp-net-core">Application Insights</a>.</p>

<p>More information about Logging and Monitoring can be found <a href="https://microsoft.github.io/code-with-engineering-playbook/Engineering/DevOpsLoggingDetailsCSharp.html">here</a>.</p>

<h1 id="owasp-2013">OWASP 2013</h1>

<p>Below is vulnerability not discussed in OWASP 2017</p>

<h2 id="a10-unvalidated-redirects-and-forwards">A10 Unvalidated redirects and forwards</h2>

<p>A protection against this was introduced in Mvc 3 template. Here is the code:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span><span class="err"> </span><span class="k">async</span><span class="err"> </span><span class="n">Task</span><span class="p">&lt;</span><span class="n">ActionResult</span><span class="p">&gt;</span><span class="err"> </span><span class="nf">LogOn</span><span class="p">(</span><span class="n">LogOnViewModel</span><span class="err"> </span><span class="n">model</span><span class="p">,</span><span class="err"> </span><span class="kt">string</span><span class="err"> </span><span class="n">returnUrl</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="err"> </span><span class="p">(</span><span class="n">ModelState</span><span class="p">.</span><span class="n">IsValid</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span><span class="err"> </span><span class="n">logonResult</span><span class="err"> </span><span class="p">=</span><span class="err"> </span><span class="k">await</span><span class="err"> </span><span class="n">_userManager</span><span class="p">.</span><span class="nf">TryLogOnAsync</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">UserName</span><span class="p">,</span><span class="err"> </span><span class="n">model</span><span class="p">.</span><span class="n">Password</span><span class="p">);</span>
        <span class="k">if</span><span class="err"> </span><span class="p">(</span><span class="n">logonResult</span><span class="p">.</span><span class="n">Success</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">await</span><span class="err"> </span><span class="n">_userManager</span><span class="p">.</span><span class="nf">LogOnAsync</span><span class="p">(</span><span class="n">logonResult</span><span class="p">.</span><span class="n">UserName</span><span class="p">,</span><span class="err"> </span><span class="n">model</span><span class="p">.</span><span class="n">RememberMe</span><span class="p">);</span><span class="err">  </span>
            <span class="k">return</span><span class="err"> </span><span class="nf">RedirectToLocal</span><span class="p">(</span><span class="n">returnUrl</span><span class="p">);</span>
<span class="p">...</span>
</code></pre></div></div>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">private</span><span class="err"> </span><span class="n">ActionResult</span><span class="err"> </span><span class="nf">RedirectToLocal</span><span class="p">(</span><span class="kt">string</span><span class="err"> </span><span class="n">returnUrl</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="err"> </span><span class="p">(</span><span class="n">Url</span><span class="p">.</span><span class="nf">IsLocalUrl</span><span class="p">(</span><span class="n">returnUrl</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="k">return</span><span class="err"> </span><span class="nf">Redirect</span><span class="p">(</span><span class="n">returnUrl</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="k">return</span><span class="err"> </span><span class="nf">RedirectToAction</span><span class="p">(</span><span class="s">"Landing"</span><span class="p">,</span><span class="err"> </span><span class="s">"Account"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Other advice:</p>

<ul>
  <li>Protect against Clickjacking and man in the middle attack from capturing an initial Non-TLS request, set the <code class="language-plaintext highlighter-rouge">X-Frame-Options</code> and <code class="language-plaintext highlighter-rouge">Strict-Transport-Security</code> (HSTS) headers. Full details <a href="https://github.com/johnstaveley/SecurityEssentials/blob/master/SecurityEssentials/Core/HttpHeaders.cs">here</a></li>
  <li>Protect against a man in the middle attack for a user who has never been to your site before. Register for <a href="https://hstspreload.org/">HSTS preload</a></li>
  <li>Maintain security testing and analysis on Web API services. They are hidden inside MEV sites, and are public parts of a site that will be found by an attacker. All of the MVC guidance and much of the WCF guidance applies to the Web API.</li>
  <li><a href="/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html">Unvalidated Redirects and Forwards Cheat Sheet</a>.</li>
</ul>

<p>More information:</p>

<p>For more information on all of the above and code samples incorporated into a sample MVC5 application with an enhanced security baseline go to <a href="http://github.com/johnstaveley/SecurityEssentials/">Security Essentials Baseline project</a></p>

<h1 id="xaml-guidance">XAML Guidance</h1>

<ul>
  <li>Work within the constraints of Internet Zone security for your application.</li>
  <li>Use ClickOnce deployment. For enhanced permissions, use permission elevation at runtime or trusted application deployment at install time.</li>
</ul>

<h1 id="windows-forms-guidance">Windows Forms Guidance</h1>

<ul>
  <li>Use partial trust when possible. Partially trusted Windows applications reduce the attack surface of an application. Manage a list of what permissions your app must use, and what it may use, and then make the request for those permissions declaratively at run time.</li>
  <li>Use ClickOnce deployment. For enhanced permissions, use permission elevation at runtime or trusted application deployment at install time.</li>
</ul>

<h2 id="wcf-guidance">WCF Guidance</h2>

<ul>
  <li>Keep in mind that the only safe way to pass a request in RESTful services is via <code class="language-plaintext highlighter-rouge">HTTP POST</code>, with <code class="language-plaintext highlighter-rouge">TLS enabled</code>. GETs are visible in the <code class="language-plaintext highlighter-rouge">querystring</code>, and a lack of TLS means the body can be intercepted.</li>
  <li>Avoid <a href="https://docs.microsoft.com/en-us/dotnet/api/system.servicemodel.basichttpbinding?view=netframework-4.7.2">BasicHttpBinding</a>. It has no default security configuration. Use <a href="https://docs.microsoft.com/en-us/dotnet/api/system.servicemodel.wshttpbinding?view=netframework-4.7.2">WSHttpBinding</a> instead.</li>
  <li>Use at least two security modes for your binding. Message security includes security provisions in the headers. Transport security means use of SSL. <a href="https://docs.microsoft.com/en-us/dotnet/framework/wcf/samples/ws-transport-with-message-credential">TransportWithMessageCredential</a> combines the two.</li>
  <li>Test your WCF implementation with a fuzzer like the <a href="https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project">ZAP</a>.</li>
</ul>

          </section>
          

          
          
          
          
          
          
          

          <nav role="navigation" aria-label="navigate page">
            <ol>
            
            
              <li class='page previous'><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Docker_Security_Cheat_Sheet"><span style="font-size: 3em; color: lightgray; vertical-align:middle;">
                  <i class="fas fa-angle-left"></i>
                </span>Docker Security Cheat Sheet</a></li>
            
            
            
              <li class='page next'><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Error_Handling_Cheat_Sheet">Error Handling Cheat Sheet<span style="font-size: 3em; color: lightgray; vertical-align:middle;">
                  <i class="fas fa-angle-right"></i>
                </span></a></li>
            
            </ol>
        </nav>
       </div>
       <hr>
       <div class="repo">
       </div>

          <div class="github-buttons">
    <a class="github-button" href="https://github.com/owasp/www-chapter-ankara/subscription" data-icon="octicon-eye" data-size="large" data-show-count="true" aria-label="Watch on GitHub">Watch</a>
    <a class="github-button" href="https://github.com/owasp/www-chapter-ankara" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star on GitHub">Star</a>
 </div>

          <div class="sidebar" role="complementary">
    

    
    
       



  
  <div class='owasp-sidebar-top'>
    <strong>The OWASP<sup>&reg;</sup> Foundation</strong> works to improve the security of software through its community-led open source software projects, 
     hundreds of chapters worldwide, tens of thousands of members, and by hosting local and global conferences.
</div>


  
  
  
<ul>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/AJAX_Security_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">AJAX Security 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Abuse_Case_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Abuse Case 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Access_Control_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Access Control 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Attack Surface Analysis 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Authentication_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Authentication 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Authorization_Testing_Automation.html">
<span style="font-size:smaller;text-decoration:none;">Authorization Testing Automation
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Bean_Validation_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Bean Validation 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/C-Based_Toolchain_Hardening.html">
<span style="font-size:smaller;text-decoration:none;">C-Based Toolchain Hardening
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/C-Based_Toolchain_Hardening_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">C-Based Toolchain Hardening 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Choosing_and_Using_Security_Questions_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Choosing and Using Security Questions 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Clickjacking_Defense_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Clickjacking Defense 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Content_Security_Policy_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Content Security Policy 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Credential_Stuffing_Prevention_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Credential Stuffing Prevention 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Cross-Site Request Forgery Prevention 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Cross Site Scripting Prevention 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Cryptographic Storage 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">DOM based XSS Prevention 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Denial_of_Service_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Denial of Service 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Deserialization_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Deserialization 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Docker_Security_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Docker Security 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/DotNet_Security_Cheat_Sheet.html">
<span style="font-size:normal;text-decoration:none;font-weight: bold;">DotNet Security 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Error_Handling_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Error Handling 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Forgot_Password_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Forgot Password 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/HTML5_Security_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">HTML5 Security 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/HTTP_Strict_Transport_Security_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">HTTP Strict Transport Security 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Injection_Prevention_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Injection Prevention 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Injection_Prevention_Cheat_Sheet_in_Java.html">
<span style="font-size:smaller;text-decoration:none;">Injection Prevention  in Java
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Input_Validation_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Input Validation 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Insecure Direct Object Reference Prevention 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/JAAS_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">JAAS 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/JSON_Web_Token_Cheat_Sheet_for_Java.html">
<span style="font-size:smaller;text-decoration:none;">JSON Web Token  for Java
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Key_Management_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Key Management 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/LDAP_Injection_Prevention_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">LDAP Injection Prevention 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Logging_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Logging 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Mass_Assignment_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Mass Assignment 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Microservices_based_Security_Arch_Doc_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Microservices based Security Arch Doc 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Multifactor_Authentication_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Multifactor Authentication 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Nodejs_security_cheat_sheet.html">
<span style="font-size:smaller;text-decoration:none;">Nodejs security cheat sheet
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">OS Command Injection Defense 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/PHP_Configuration_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">PHP Configuration 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Password_Storage_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Password Storage 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Pinning_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Pinning 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Protect_FileUpload_Against_Malicious_File.html">
<span style="font-size:smaller;text-decoration:none;">Protect FileUpload Against Malicious File
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Query_Parameterization_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Query Parameterization 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/REST_Assessment_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">REST Assessment 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/REST_Security_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">REST Security 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Ruby_on_Rails_Cheatsheet.html">
<span style="font-size:smaller;text-decoration:none;">Ruby on Rails 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/SAML_Security_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">SAML Security 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">SQL Injection Prevention 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Securing_Cascading_Style_Sheets_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Securing Cascading Style Sheets 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Server Side Request Forgery Prevention 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Session_Management_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Session Management 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/TLS_Cipher_String_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">TLS Cipher String 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Third_Party_Javascript_Management_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Third Party Javascript Management 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Threat_Modeling_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Threat Modeling 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Transaction_Authorization_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Transaction Authorization 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Transport Layer Protection 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Unvalidated Redirects and Forwards 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/User_Privacy_Protection_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">User Privacy Protection 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Virtual_Patching_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Virtual Patching 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Vulnerability_Disclosure_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Vulnerability Disclosure 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Vulnerable_Dependency_Management_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Vulnerable Dependency Management 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/Web_Service_Security_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">Web Service Security 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">XML External Entity Prevention 
</span></a></li>

<li><a href="https://github.com/pages/owaspankara/www-chapter-ankara/cheatsheets/XML_Security_Cheat_Sheet.html">
<span style="font-size:smaller;text-decoration:none;">XML Security 
</span></a></li>

</ul>

  
  
  

  <div class='owasp-sidebar-bottom'>
<h3>Upcoming Global Events</h3>
   <ul>
      <!--
      <li><a href="https://appsecdays.org/?utm_source=owasp-web&utm_medium=right-col&utm_campaign=www-chapter-ankara" target="_blank" rel="noopener">Virtual AppSec Days, Summer</a></li>
      <li><a href="https://sf.globalappsec.org/?utm_source=owasp-web&utm_medium=right-col&utm_campaign=www-chapter-ankara" target="_blank" rel="noopener">Global AppSec SF October 19th-23rd</a></li>
     <li><a href="https://dublin.globalappsec.org/?utm_source=owasp-web&utm_medium=right-col&utm_campaign=www-chapter-ankara" target="_blank" rel="noopener">Global AppSec Dublin February 15-19th, 2021</a></li>
     -->
   </ul>
</div>


  <!--<div>
    <h3>OWASP News & Opinions</h3>
    <ul>
    	
    </ul>	
  </div>-->
</div>

      </div>
    </main>
    <footer>
  
  <section class="member">

  <script type="text/javascript">
    var members = [];
    $(function() {
      
      corp_members = YAML.load('https://owasp.org/assets/sitedata/corp_members.yml');
      $.each(corp_members, function (index) {
        members.push(this);
        });
        var randomIndexUsed = [];
        var counter = 0;
        var numberOfImages = 9;
        if(members.length > 0)
        {
          var htmlstring = "";
          while (counter < numberOfImages)
          {
              var randomIndex;
              var img;

              randomIndex = Math.floor(Math.random() * members.length);

              if (randomIndexUsed.indexOf(randomIndex) == "-1")
              {
                  counter++;
                  htmlstring += '<a href="'+ members[randomIndex]["url"] + '" class="member-logo" rel="sponsored noopener noreferrer" target="_blank" onclick="handleOutboundLinkClicks(event);"><img src="https://owasp.org' + members[randomIndex]["image"] + '" alt="image"/></a>';
                  
                  randomIndexUsed.push(randomIndex);
              }
          }

          $("#corp_member_div").html(htmlstring);
         
          var randi = Math.floor(Math.random() * members.length);
          htmlstring = '<h2>Spotlight: ' + members[randi]["name"] + '</h2>';
          htmlstring += '<a href="'+ members[randi]["url"] + '" rel="sponsored nopener noreferrer" target="_blank" onclick="handleOutboundLinkClicks(event);"><img src="https://owasp.org' + members[randi]["image"] + '" alt="image" /></a>';
          htmlstring += '<p>' + members[randi]["description"] + '</p>';
          $(".member-spotlight").html(htmlstring);
        }
    });
  </script>
  <div class="member-wrapper">
    <section class="member-spotlight">
    </section>
    <section class="member-list">
      <h2>Corporate Supporters</h2>
      <div id="corp_member_div">
      </div>
      <div class="member-cta">
        <a class="callout-link" href="/supporters">Become a corporate supporter</a>
      </div>
    </section>
  </div>
</section>

  
  <section class="footer-wrapper">
    <section class="social">
<a href="https://owasp-slack.herokuapp.com" aria-label="slack group" target="_blank" rel="noopener noreferrer"><i class="fa fa-lg fa-slack"></i></a>
<a href="https://www.facebook.com/OWASPFoundation" aria-label="facebook group" target="_blank" rel="noopener noreferrer"><i class="fa fa-lg fa-facebook-square"></i></a>
<a href="https://twitter.com/owasp" aria-label="twitter account" target="_blank" rel="noopener noreferrer"><i class="fa fa-lg fa-twitter"></i></a>
<a href="https://www.linkedin.com/company/owasp/" aria-label="linkedin account" target="_blank" rel="noopener noreferrer"><i class="fa fa-lg fa-linkedin"></i></a>
<a href="https://www.youtube.com/user/OWASPGLOBAL" aria-label="youtube account" target="_blank" rel="noopener noreferrer"><i class="fa fa-lg fa-youtube-square"></i></a>
</section>
    <nav class="bot-nav" role="navigation" aria-label="secondary navigation">
      <ul>
        <li><a href="/">HOME</a></li>
        <li><a href="/projects/">PROJECTS</a></li>
        <li><a href="/chapters/">CHAPTERS</a></li>
        <li><a href="/events/">EVENTS</a></li>
        <li><a href="/about/">ABOUT</a></li>
        <li><a href="/www-policy/operational/privacy">PRIVACY</a></li>
        <li><a href="/sitemap/">SITEMAP</a></li>
        <li><a href="/contact/">CONTACT</a></li>
      </ul>
    </nav>
    <p class="disclaimer">
        OWASP, Open Web Application Security Project, and Global AppSec are registered trademarks and AppSec Days, AppSec California, AppSec Cali, SnowFROC, LASCON, and the OWASP logo are trademarks of the OWASP Foundation, Inc. Unless otherwise specified, all content on the site is Creative Commons Attribution-ShareAlike v4.0 and provided without warranty of service or accuracy. For more information, please refer to our <a href="/www-policy/operational/general-disclaimer.html">General Disclaimer</a>. OWASP does not endorse or recommend commercial products or services, allowing our community to remain vendor neutral with the collective wisdom of the best minds in software security worldwide. Copyright 2020, OWASP Foundation, Inc.      
    </p>
  </section>
</footer>

  </body>
</html>


